lastest.all<-c()
pods.all<-c()
for(y in 1:length(years)){
yrdat<-searsps[searsps$orcayear==years[y],]
years.all<-c(years.all,years[y])
nobs.all<-c(nobs.all,length(yrdat$day[yrdat$AllSRobs==1]))
firstest.all<-c(firstest.all,min(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
lastest.all<-c(lastest.all,max(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
mean.all<-c(mean.all,mean(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
pods.all<-c(pods.all,pods[p])
}
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all))
colnames(sears.df)[1:3]<-c("pod","year","nobs")
#Now try for sears data
alpha=0.10
k=20
pods.all.p<-c()
regions.all.p<-c()
years.all.p<-c()
nobs.all.p<-c()
firstest.all.p<-c()
lastest.all.p<-c()
mean.all.p<-c()
meandiffs.all<-c()
firstdiffs.all<-c()
years<-unique(sears.df$years.all)
p=1
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days.lime)==podcols[p])
regdat<-orcasum.days.sears
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all.p<-c(pods.all.p,pods[p])
years.all.p<-c(years.all.p,years[y])
nobs.all.p<-c(nobs.all.p,length(yrdat$day[yrdat[,colnum]==1]))
firstest.all.p<-rbind(firstest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha=alpha,k=k))
lastest.all.p<-rbind(lastest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]), upper=TRUE,alpha=alpha,k=k))
mean.all.p<-rbind(mean.all.p,
c(mean(yrdat$daysaftmar31[yrdat[,colnum]==1], na.rm=TRUE),#mean
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha),#lower ci
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),1-alpha)))#upper ci
meandiffs.all<-c(meandiffs.all,mean(diff(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]))))
}
}
sears.df <- cbind(sears.df,pods.all.p,years.all.p,nobs.all.p,firstest.all.p,lastest.all.p,mean.all.p)
sears.df
pods.all.p
unique(sears.df$years.all)
sears.df
years<-unique(sears.df$year)
p=1
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days.lime)==podcols[p])
regdat<-orcasum.days.sears
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all.p<-c(pods.all.p,pods[p])
years.all.p<-c(years.all.p,years[y])
nobs.all.p<-c(nobs.all.p,length(yrdat$day[yrdat[,colnum]==1]))
firstest.all.p<-rbind(firstest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha=alpha,k=k))
lastest.all.p<-rbind(lastest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]), upper=TRUE,alpha=alpha,k=k))
mean.all.p<-rbind(mean.all.p,
c(mean(yrdat$daysaftmar31[yrdat[,colnum]==1], na.rm=TRUE),#mean
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha),#lower ci
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),1-alpha)))#upper ci
meandiffs.all<-c(meandiffs.all,mean(diff(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]))))
}
}
sears.df <- cbind(sears.df,pods.all.p,years.all.p,nobs.all.p,firstest.all.p,lastest.all.p,mean.all.p)
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all))
colnames(sears.df)[1:3]<-c("pod","year","nobs")
#Now try for sears data
alpha=0.10
k=20
pods.all.p<-c()
regions.all.p<-c()
years.all.p<-c()
nobs.all.p<-c()
firstest.all.p<-c()
lastest.all.p<-c()
mean.all.p<-c()
meandiffs.all<-c()
firstdiffs.all<-c()
years<-unique(sears.df$year)
p=1
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days.lime)==podcols[p])
regdat<-orcasum.days.sears
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all.p<-c(pods.all.p,pods[p])
years.all.p<-c(years.all.p,years[y])
nobs.all.p<-c(nobs.all.p,length(yrdat$day[yrdat[,colnum]==1]))
firstest.all.p<-rbind(firstest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha=alpha,k=k))
lastest.all.p<-rbind(lastest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]), upper=TRUE,alpha=alpha,k=k))
mean.all.p<-rbind(mean.all.p,
c(mean(yrdat$daysaftmar31[yrdat[,colnum]==1], na.rm=TRUE),#mean
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha),#lower ci
quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),1-alpha)))#upper ci
meandiffs.all<-c(meandiffs.all,mean(diff(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]))))
}
}
pods.all.p
years.all.p
nobs.all.p
firstest.all.p
lastest.all.p,
lastest.all.p
sears.df$years.all<-as.numeric(sears.df$years.all)
sears.df$year<-as.numeric(sears.df$years)
sears.df$year<-as.numeric(sears.df$year)
sears.df$firstest.all<-as.numeric(sears.df$firstest.all)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$years.all,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$firstest.all~sears.df$years.all)
sears.df
sears.df <- cbind(sears.df,pods.all.p,years.all.p,nobs.all.p,firstest.all.p,lastest.all.p,mean.all.p)
sears.df$year<-as.numeric(sears.df$year)
sears.df$firstest.all<-as.numeric(sears.df$firstest.all)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$years.all,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16)
sears.df
colnames(sears.df)
colnames(sears.df)[10:18]<-c("firstest.p","firstest.plcl","firstest.pucl","lastest.p","lastest.plcl","lastest.pucl","mean.p","mean.plcl","mean.pucl")
sears.df$year<-as.numeric(sears.df$year)
sears.df$firstest.all<-as.numeric(sears.df$firstest.all)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$years.all,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$firstest.all~sears.df$years.all)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
mod
sears.df$year<-as.numeric(sears.df$year)
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
mod<-lm(sears.df$firstest.p~sears.df$year)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(searsdf$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(150-280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(150,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(120,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(100,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(70,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(60,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
sears.df$firstest.p
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(15,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,
if(summary(mod)$coef[2,4]<alpha){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]>alpha){abline(mod, lty=3, col="blue")}
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
f$firstest.p~sears.df$year)
if(
summary(mod)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(15,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,
mod<-lm(sears.df$firstest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(0,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,
mod<-lm(sears.df$firstest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
sears.df
plot(df$year,df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=21, bg="gray")
mod<-lm(df$lastest.all~df$year)
plot(sears.df$year,sears.df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$lastest.all~df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(searsdf$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
lastest.p
sears.df$lastest.p
plot(sears.df$year,sears.df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=16, ylim=c(140,365))
mod<-lm(sears.df$lastest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(0,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,pch=16, col= "blue")
mod<-lm(sears.df$firstest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
plot(sears.df$year,sears.df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=16, ylim=c(140,365))
mod<-lm(sears.df$lastest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
plot(sears.df$year,sears.df$mean.all,xlab="year",ylab="mean obs doy", main="", bty="l", pch=21, bg="gray")
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(0,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,pch=16, col= "blue")
mod<-lm(sears.df$firstest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
plot(sears.df$year,sears.df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=16, ylim=c(140,365))
mod<-lm(sears.df$lastest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1,col = "blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3,col = "blue")}
plot(sears.df$year,sears.df$mean.all,xlab="year",ylab="mean obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$mean.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
head(sears.df)
arrows(sears.df$year,sears.df$mean.plcl,sears.df$year,sears.df$mean.pucl,code=3,length=0)
seras.df
sears.df
#10. Fit some basic linear models to west seattle only
searsd<-read.csv("data/SearsCompiled.csv")
#first clean the data and get in same format as orcamaster
source("analyses/orcaphen/source/clean_sears.R")
source("analyses/orcaphen/source/orca_runlinmods_sears.R")
sears.df
cbind(sears.df$mean.all,sears.df$mean.p)
mean.all.p
quartz(height=6, width=15)
par(mfrow=c(1,3))
#Looks like continuous data from 2002 through 2018 (except for 2008 and 2014 (orcayear=2) which have very few sightings- why is this?) in FishAreas 10 and 11
years<-seq(2001,2017, by=1)#restrict to these years for orcayears
#years<-years[-which(years==2008)]
years<-years[-which(years==2013)]#only observed on 1 day inb
#Look at trends in SRKW phenology across all years, for all pods
years.all<-c()
nobs.all<-c()
firstest.all<-c()
mean.all<-c()
lastest.all<-c()
pods.all<-c()
#Look at trends in SRKW phenology across all years, for all pods
years.all<-c()
nobs.all<-c()
firstest.all<-c()
mean.all<-c()
lastest.all<-c()
pods.all<-c()
lower.all<-c()
upper.all<-c()
for(y in 1:length(years)){
yrdat<-searsps[searsps$orcayear==years[y],]
years.all<-c(years.all,years[y])
nobs.all<-c(nobs.all,length(yrdat$day[yrdat$AllSRobs==1]))
firstest.all<-c(firstest.all,min(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
lastest.all<-c(lastest.all,max(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
mean.all<-c(mean.all,mean(yrdat$daysaftmar31[yrdat$AllSRobs==1], na.rm=TRUE))
lower.all<-c(lower.all,quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha))#lower ci
upper.all<-c(upper.all,quantile(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),1-alpha))#upper ci
pods.all<-c(pods.all,pods[p])
}
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all))
colnames(sears.df)[1:3]<-c("pod","year","nobs")
#Now try for sears data
alpha=0.10
k=20
pods.all.p<-c()
regions.all.p<-c()
sears.df
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all.lower.all,upperall))
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all,lower.all,upperall))
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all,lower.all,upper.all))
colnames(sears.df)[1:3]<-c("pod","year","nobs")
#Now try for sears data
alpha=0.10
k=20
pods.all.p<-c()
regions.all.p<-c()
years.all.p<-c()
nobs.all.p<-c()
firstest.all.p<-c()
lastest.all.p<-c()
meandiffs.all<-c()
firstdiffs.all<-c()
years<-unique(sears.df$year)
p=1
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days.lime)==podcols[p])
regdat<-orcasum.days.sears
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all.p<-c(pods.all.p,pods[p])
years.all.p<-c(years.all.p,years[y])
nobs.all.p<-c(nobs.all.p,length(yrdat$day[yrdat[,colnum]==1]))
firstest.all.p<-rbind(firstest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha=alpha,k=k))
lastest.all.p<-rbind(lastest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]), upper=TRUE,alpha=alpha,k=k))
meandiffs.all<-c(meandiffs.all,mean(diff(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]))))
}
}
sears.df <- cbind(sears.df,pods.all.p,years.all.p,nobs.all.p,firstest.all.p,lastest.all.p)
colnames(Sears.all)
colnames(sears.df)
colnames(sears.df)[12:18]<-c("firstest.p","firstest.plcl","firstest.pucl","lastest.p","lastest.plcl","lastest.pucl")
sears.df$year<-as.numeric(sears.df$year)
sears.df <- as.data.frame(cbind(pods.all,years.all,nobs.all,firstest.all,lastest.all,mean.all,lower.all,upper.all))
colnames(sears.df)[1:3]<-c("pod","year","nobs")
#Now try for sears data
alpha=0.10
k=20
pods.all.p<-c()
regions.all.p<-c()
years.all.p<-c()
nobs.all.p<-c()
firstest.all.p<-c()
lastest.all.p<-c()
meandiffs.all<-c()
firstdiffs.all<-c()
years<-unique(sears.df$year)
p=1
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days.lime)==podcols[p])
regdat<-orcasum.days.sears
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all.p<-c(pods.all.p,pods[p])
years.all.p<-c(years.all.p,years[y])
nobs.all.p<-c(nobs.all.p,length(yrdat$day[yrdat[,colnum]==1]))
firstest.all.p<-rbind(firstest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]),alpha=alpha,k=k))
lastest.all.p<-rbind(lastest.all.p,est.limit(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]), upper=TRUE,alpha=alpha,k=k))
meandiffs.all<-c(meandiffs.all,mean(diff(as.integer(yrdat$daysaftmar31[yrdat[,colnum]==1]))))
}
}
sears.df <- cbind(sears.df,pods.all.p,years.all.p,nobs.all.p,firstest.all.p,lastest.all.p)
colnames(sears.df)[12:17]<-c("firstest.p","firstest.plcl","firstest.pucl","lastest.p","lastest.plcl","lastest.pucl")
seras.df
sears.df
sears.df$year<-as.numeric(sears.df$year)
sears.df$firstest.all<-as.numeric(sears.df$firstest.all)
quartz(height=8,width=25)
par(mfrow=c(1,6))
plot(sears.df$year,sears.df$firstest.all,xlab="year",ylab="first obs doy", main="", bty="l", pch=16, ylim=c(0,280))
mod<-lm(sears.df$firstest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$firstest.plcl,sears.df$year,sears.df$firstest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$firstest.p,pch=16, col = "blue",cex=1.2)
points(sears.df$year,sears.df$firstest.p,pch=16, col= "blue")
mod<-lm(sears.df$firstest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3, col="blue")}
plot(sears.df$year,sears.df$lastest.all,xlab="year",ylab="last obs doy", main="", bty="l", pch=16, ylim=c(140,365))
mod<-lm(sears.df$lastest.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,sears.df$lastest.plcl,sears.df$year,sears.df$lastest.pucl,col="blue",code=3,length=0)
points(sears.df$year,sears.df$lastest.p,pch=16, col = "blue",cex=1.2)
mod<-lm(sears.df$lastest.p~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1,col = "blue")}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3,col = "blue")}
plot(sears.df$year,sears.df$mean.all,xlab="year",ylab="mean obs doy", main="", bty="l", pch=16)
mod<-lm(sears.df$mean.all~sears.df$year)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1)}
if(summary(mod)$coef[2,4]<.1){abline(mod, lty=3)}
arrows(sears.df$year,sears.df$lower.all,sears.df$year,sears.df$upper.all,code=3,length=0)
head(seras.df)
head(sears.df)
sears.df$lower.all
arrows(sears.df$year,as.numeric(sears.df$lower.all),sears.df$year,as.numeric(sears.df$upper).all,code=3,length=0)
arrows(sears.df$year,as.numeric(sears.df$lower.all),sears.df$year,as.numeric(sears.df$upper.all),code=3,length=0)
sears.df
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
arrows(sears.df$year,as.numeric(sears.df$lower.all),sears.df$year,as.numeric(sears.df$upper.all),code=3,length=0)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
