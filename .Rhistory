### Run MCMC Analysis using jags
library(R2jags)
library(rstan)
library(rjags)
dyn.load(file, DLLpath = DLLpath, ...)
library("jagsUI", lib.loc="~/Library/R/3.5/library")
detach("package:jagsUI", unload=TRUE)
library("R2jags", lib.loc="~/Library/R/3.5/library")
library("R2WinBUGS", lib.loc="~/Library/R/3.5/library")
library("rjags", lib.loc="~/Library/R/3.5/library")
library("jagsUI", lib.loc="~/Library/R/3.5/library")
update.packages("jagsUI")
update.packages("rjags")
update.packages("r2jags")
library(R2jags)
devtools::install_url("http://sourceforge.net/projects/mcmc-jags/files/rjags/3/rjags_3-2.tar.gz",
args="--configure-args='--with-jags-include=/Users/casallas/homebrew/opt/jags/include/JAGS
--with-jags-lib=/Users/casallas/homebrew/opt/jags/lib'
"
)
devtools::install_url("https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Mac%20OS%20X/",
args="--configure-args='--with-jags-include=/Users/casallas/homebrew/opt/jags/include/JAGS
--with-jags-lib=/Users/casallas/homebrew/opt/jags/lib'
"
)
remove.packages("rjags", lib="~/Library/R/3.5/library")
remove.packages("jagsUI", lib="~/Library/R/3.5/library")
remove.packages("R2jags", lib="~/Library/R/3.5/library")
library("rjags", lib.loc="~/Library/R/3.5/library")
remove.packages("rjags", lib="~/Library/R/3.5/library")
library("R2WinBUGS", lib.loc="~/Library/R/3.5/library")
library("R2jags", lib.loc="~/Library/R/3.5/library")
install.packages("rjags")
library("rjags", lib.loc="~/Library/R/3.5/library")
remove.packages("rjags", lib="~/Library/R/3.5/library")
remove.packages("R2jags", lib="~/Library/R/3.5/library")
install.packages("jagsUI")
library(jagsUI)
library("jagsUI", lib.loc="~/Library/R/3.5/library")
install.packages("~/Downloads/JAGS-4.3.0.dmg", repos = NULL)
library("jagsUI", lib.loc="~/Library/R/3.5/library")
detach("package:jagsUI", unload=TRUE)
remove.packages("jagsUI", lib="~/Library/R/3.5/library")
library("rjags", lib.loc="~/Library/R/3.5/library")
devtools::install_url("http://sourceforge.net/projects/mcmc-jags/files/rjags/4/rjags_4-4.tar.gz")
devtools::install_url("http://sourceforge.net/projects/mcmc-jags/files/rjags/4/rjags_4-4.tar.gz")
library(rjags)
devtools::install_url("http://sourceforge.net/projects/mcmc-jags/files/rjags/4/rjags_4-4.tar.gz",)
remove.packages("rjags", lib="~/Library/R/3.5/library")
4 February 2019
#housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
setwd("~/Documents/GitHub/fishphen")
#or from laptop:
#setwd("/Users/aileneettinger/Documents/GitHub/fishphen")
# Load libraries
library(dplyr)
library(mgcv)
library(scales)
# 1. Get the data
d <- read.csv("data/AppendixII.csv")
# 2. Clean the data (also saved in output/AppendixII_cleaned,csv)
source("analyses/clean_orca.R")
#Create a new column that combines Pod and Likely Pod columna and removes spaces
d$Pod.cl<-d$Pod
#Always use Likely Pod column, when it is not blank:
d$Pod.cl[d$LikelyPod!="" & d$LikelyPod!=" "]<-d$LikelyPod[d$LikelyPod!="" & d$LikelyPod!=" "]
#perhaps also stick with Pod when LikelyPod has a "?" grep("?",d$LikelyPod,)
#remove non-orca data
#d<-d[d$Pod.cl=="HB?"|d$Pod.cl=="Not Orcas",]
#only using fishing areas in Washington's Salish Sea
d<-d[d$FishArea %in% c("01","02","03","04","05","06","07","09","10","11","12","13","81","82"),]#not sure where 17, 18, 19, 20, 28, 29 are...need to find out. also, where is 42583,42584
#Assign region, based on fishing area:
d$region<-"ps"
d$region[d$FishArea=="07"|d$FishArea=="06"|d$FishArea=="05"|d$FishArea=="04"|d$FishArea=="19C"|d$FishArea== "18C"|d$FishArea=="20C"]]<-"uss"
d$region[d$FishArea=="01"|d$FishArea=="02"|d$FishArea=="03"]<-"oc"#outer coast
d$region[d$FishArea=="07"|d$FishArea=="06"|d$FishArea=="05"|d$FishArea=="04"|d$FishArea=="19C"|d$FishArea== "18C"|d$FishArea=="20C"]<-"uss"
d$region[d$FishArea=="01"|d$FishArea=="02"|d$FishArea=="03"]<-"oc"#outer coast
#Assign region, based on fishing area:
d$region<-"ps"
d$region[d$FishArea=="07"|d$FishArea=="06"|d$FishArea=="05"|d$FishArea=="04"|d$FishArea=="19C"|d$FishArea== "18C"|d$FishArea=="20C"]<-"uss"
d$region[d$FishArea=="01"|d$FishArea=="02"|d$FishArea=="03"]<-"oc"#outer coast
#Add week and day of year (day)
d$day<-strftime(strptime(paste(d$Month, d$Day, d$Year, sep="."),format= "%m.%d.%Y"),format= "%j")
d$week<-strftime(strptime(paste(d$Month, d$Day, d$Year, sep="."),format= "%m.%d.%Y"), format = "%V")#new weeks start on mondays
d<-d[-which(is.na(d$day)),]
#Add a column for presences (1/0) for each pod, for Ts, and for SRKWs
d$J<-0
d$J[grep("J",d$Pod.cl)]<- 1
d$K<-0
d$K[grep("K",d$Pod.cl)]<- 1
d$L<-0
d$L[grep("L",d$Pod.cl)]<- 1
d$SRKW<-0
d$SRKW[grep("SR",d$Pod.cl)]<- 1
d$SRKW[d$J==1|d$K==1|d$L==1]<- 1
d$Orcas<-1
unique(d$Pod.cl)
sort(unique(d$Pod.cl))
d$Trans<-0
d$Trans[grep("T",d$Pod.cl)]<- 1
#only data after 1978
d<-d[d$Year>1977,]
# Add a column that combines :
#1) day, year, and region;
#2) day, year, and fishing area
#3) week, year, and region;
#4) week, year, and fishing are;
#to use to total up observations for later analyses
d$yrdayregion<-paste(d$Year, d$day,d$region,sep="_")
d$yrwkregion<-paste(d$Year, d$week,d$region,sep="_")
d$yrdayfa<-paste(d$Year, d$day,d$FishArea,sep="_")
d$yrwkfa<-paste(d$Year, d$week,d$FishArea,sep="_")
d$yrregion<-paste(d$Year,d$region,sep="_")
d$yrfa<-paste(d$Year, d$FishArea,sep="_")
#Plot a bunch of different things:
#1. Plot the total number of orca observations per year in each region since 1978
#a. All pods together
#b .Each pod separately
obs = aggregate(Orcas ~yrregion, data = d,sum)
js = aggregate(J ~yrregion, data = d,sum)
ks = aggregate(K~yrregion, data = d,sum)
ls = aggregate(L~yrregion, data = d,sum)
srs = aggregate(SRKW~yrregion, data = d,sum)
orcasum<-cbind(js,ks[,2],ls[,2],srs[,2],obs[2])
colnames(orcasum)[2:6]<-c("Jobs","Kobs","Lobs","AllSRobs","AllOrcas")
orcasum$year<-substr(orcasum$yrregion,1,4)
orcasum$region<-substr(orcasum$yrregion,6,nchar(orcasum$yrregion))
quartz()
#par(mfrow)
#start with uss, all SRKWs
plot(orcasum$year[orcasum$region=="uss"],orcasum$AllSRobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="All SRKW sightings, 1978-2017")
lines(orcasum$year[orcasum$region=="ps"],orcasum$AllSRobs[orcasum$region=="ps"], lwd=2,lty=2)
lines(orcasum$year[orcasum$region=="oc"],orcasum$AllSRobs[orcasum$region=="oc"], lwd=2,lty=3)
lines(orcasum$year[orcasum$region=="uss"],orcasum$Jobs[orcasum$region=="uss"],lwd=2,col="blue")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Jobs[orcasum$region=="ps"], lwd=2,lty=2, col="blue")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Jobs[orcasum$region=="oc"], lwd=2,lty=3, col="blue")
lines(orcasum$year[orcasum$region=="uss"],orcasum$Kobs[orcasum$region=="uss"],lwd=2,col="purple")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Kobs[orcasum$region=="ps"], lwd=2,lty=2, col="purple")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Kobs[orcasum$region=="oc"], lwd=2,lty=3, col="purple")
lines(orcasum$year[orcasum$region=="uss"],orcasum$Lobs[orcasum$region=="uss"],lwd=2,col="darkred")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Lobs[orcasum$region=="ps"], lwd=2,lty=2, col="darkred")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Lobs[orcasum$region=="oc"], lwd=2,lty=3, col="darkred")
quartz()
#par(mfrow)
#start with uss, all SRKWs
plot(orcasum$year[orcasum$region=="uss"],orcasum$AllSRobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="All SRKW sightings, 1978-2017")
lines(orcasum$year[orcasum$region=="ps"],orcasum$AllSRobs[orcasum$region=="ps"], lwd=2,lty=2)
lines(orcasum$year[orcasum$region=="oc"],orcasum$AllSRobs[orcasum$region=="oc"], lwd=2,lty=3)
legend("topleft",legend=c("Upper Salish Sea","Puget Sound","Outer Coast","Js","Ks","Ls"), lty=c(1,2,3,1,1,1),col=c("black","black","black","blue","purple","darkred"), bty="n")
quartz()
#par(mfrow)
#start with uss, all SRKWs
plot(orcasum$year[orcasum$region=="uss"],orcasum$AllSRobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="All SRKW sightings, 1978-2017")
legend("topleft",legend=c("Upper Salish Sea","Puget Sound","Outer Coast"), lty=c(1,2,3),col=c("black"), bty="n")
lines(orcasum$year[orcasum$region=="ps"],orcasum$AllSRobs[orcasum$region=="ps"], lwd=2,lty=2)
lines(orcasum$year[orcasum$region=="oc"],orcasum$AllSRobs[orcasum$region=="oc"], lwd=2,lty=3)
quartz()
par(mfrow=c(3,1))
#start with uss, all SRKWs
plot(orcasum$year[orcasum$region=="uss"],orcasum$Jobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="J pod sightings, 1978-2017", col="blue")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Jobs[orcasum$region=="ps"], lwd=2,lty=2, col="blue")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Jobs[orcasum$region=="oc"], lwd=2,lty=3, col="blue")
legend("topleft",legend=c("uss","ps","oc"), col="blue", lty=c(1,2,3), bty="n")
#Kp
#Kpod
plot(orcasum$year[orcasum$region=="uss"],orcasum$Kobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="K pod sightings, 1978-2017", col="purple")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Kobs[orcasum$region=="ps"], lwd=2,lty=2, col="purple")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Kobs[orcasum$region=="oc"], lwd=2,lty=3, col="purple")
#Lpod
plot(orcasum$year[orcasum$region=="uss"],orcasum$Lobs[orcasum$region=="uss"],type="l",xlab="Year",ylab="Number of detections", lwd=2,bty="l", main="K pod sightings, 1978-2017", col="darkred")
lines(orcasum$year[orcasum$region=="ps"],orcasum$Lobs[orcasum$region=="ps"], lwd=2,lty=2, col="darkred")
lines(orcasum$year[orcasum$region=="oc"],orcasum$Lobs[orcasum$region=="oc"], lwd=2,lty=3, col="darkred")
obs.days = aggregate(Orcas ~yrdayregion, data = d,sum)
js.days = aggregate(J ~yrdayregion, data = d,sum)
ks.days = aggregate(K~yrdayregion, data = d,sum)
ls.days = aggregate(L~yrdayregion, data = d,sum)
srs.days = aggregate(SRKW~yrdayregion, data = d,sum)
orcasum.days<-cbind(js.days,ks.days[,2],ls.days[,2],srs.days[,2],obs.days[2])
colnames(orcasum.days)[2:6]<-c("Jobs","Kobs","Lobs","AllSRobs","AllOrcas")
orcasum.days$year<-substr(orcasum.days$yrdayregion,1,4)
orcasum.days$day<-substr(orcasum.days$yrdayregion,6,8)
orcasum.days$region<-substr(orcasum.days$yrdayregion,10,nchar(orcasum.days$yrdayregion))
orcasum.days$Jpres<-orcasum.days$Jobs
orcasum.days$Jpres[orcasum.days$Jobs>0]<-1
orcasum.days$Kpres<-orcasum.days$Kobs
orcasum.days$Kpres[orcasum.days$Kobs>0]<-1
orcasum.days$Lpres<-orcasum.days$Lobs
orcasum.days$Lpres[orcasum.days$Lobs>0]<-1
orcasum.days$AllSRpres<-orcasum.days$AllSRobs
orcasum.days$AllSRpres[orcasum.days$AllSRobs>0]<-1
#summarize whale days per year by region
wdays<-as.data.frame(tapply(orcasum.days$AllSRpres,list(orcasum.days$year,orcasum.days$region),sum))
quartz()
#par(mfrow)
#start with uss, all SRKWs
plot(rownames(wdays),wdays$uss,type="l",xlab="Year",ylab="Number of whale days", lwd=2,bty="l", main="All SRKW sightings, 1978-2017", ylim=c(0,200))
lines(rownames(wdays),wdays$ps, lwd=2,lty=2)
lines(rownames(wdays),wdays$oc, lwd=2,lty=3)
legend("topleft",legend=c("Upper Salish Sea","Puget Sound","Outer Coast"), lty=c(1,2,3),col="black", bty="n")
wdays.J<-as.data.frame(tapply(orcasum.days$Jpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.K<-as.data.frame(tapply(orcasum.days$Kpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.L<-as.data.frame(tapply(orcasum.days$Lpres,list(orcasum.days$year,orcasum.days$region),sum))
quartz()
par(mfrow=c(3,1))#par(mfrow)
#J pod
plot(rownames(wdays.J),wdays.J$uss,type="l",xlab="Year",ylab="Number of whale days", lwd=2,bty="l", main="J sightings, 1978-2017", ylim=c(0,200), col="blue")
lines(rownames(wdays.J),wdays.J$ps, lwd=2,lty=2, col="blue")
lines(rownames(wdays.J),wdays.J$oc, lwd=2,lty=3, col="blue")
legend("topleft",legend=c("Upper Salish Sea","Puget Sound","Outer Coast"), lty=c(1,2,3),col="blue", bty="n")
#K
plot(rownames(wdays.K),wdays.K$uss,type="l",xlab="Year",ylab="Number of whale days", lwd=2,bty="l", main="K sightings, 1978-2017", ylim=c(0,200), col="purple")
lines(rownames(wdays.K),wdays.K$ps, lwd=2,lty=2, col="purple")
lines(rownames(wdays.K),wdays.K$oc, lwd=2,lty=3, col="purple")
#L
plot(rownames(wdays.L),wdays.L$uss,type="l",xlab="Year",ylab="Number of whale days", lwd=2,bty="l", main="L sightings, 1978-2017", ylim=c(0,200), col="darkred")
lines(rownames(wdays.L),wdays.L$ps, lwd=2,lty=2, col="darkred")
lines(rownames(wdays.L),wdays.L$oc, lwd=2,lty=3, col="darkred")
head(wdays)
head(orcasum.days)
years = unique(orcasum.days$year)
plot(0, type = 'n', axes = FALSE, ann = FALSE, xlim=c(1,366),ylim=c(min(years,max(years))),ylab="",xlab="DOY")
years = unique(orcasum.days$year)
plot(0, type = 'n', axes = FALSE, ann = FALSE, xlim=c(1,366),ylim=c(min(years,max(years))),ylab="",xlab="DOY")
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', axes = FALSE, ann = FALSE, xlim=c(1,366),ylim=c(min(years),max(years)),ylab="",xlab="DOY")
c(min(years),max(years))
plot(0, type = 'n', axes = FALSE, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', axes = TRUE, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
lines(x=days,y=rep(y,length=length(days)))
y=2013
days = orcasum.days$day[orcasum.days$year==y]
lines(x=days,y=rep(y,length=length(days)))
regdat<-orcasum.days[orcasum.days$region=="uss"]
head(orcasum.days)
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
regdat<-orcasum.days[orcasum.days$region=="uss",]
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
regdat<-orcasum.days[orcasum.days$region=="uss",]
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
}
quartz()
par(mfrow=c(1,3))
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY")
regdat<-orcasum.days[orcasum.days$region=="uss",]
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
#points(x=days,y=rep(y,length=length(days)))
lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
regions=unique(orcasum.days$region)
#xaxis is doy
#do for 3 regions
quartz()
par(mfrow=c(1,3))
regions=unique(orcasum.days$region)
for(r in 1:regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
regions
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
paste(r)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
paste(r)
quartz()
par(mfrow=c(1,3))
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=r)
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
plot(0, type = 'n', las=1, ann = FALSE, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main="paste(r)")
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main="paste(r)")
quartz()
par(mfrow=c(1,3))
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
days = orcasum.days$day[orcasum.days$year==y]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
quartz()
par(mfrow=c(1,3))
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
days = regdat$day[regdat$year==y]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
quartz()
par(mfrow=c(1,3))
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
days = regdat$day[regdat$year==y]
#points(x=days,y=rep(y,length=length(days)))
lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
head(orcasum.days)
#Plotas observed or not by doy and year
#yaxis is year
#xaxis is doy
#do for 3 regions
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
#Plotas observed or not by doy and year
#yaxis is year
#xaxis is doy
#do for 3 regions
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
p=1
colnum<-which(colnames(orcasum.days)==podcol[p])
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
podcols[p]
which(colnames(orcasum.days)==podcols[p])
days = regdat$day[regdat$year==y & regdat[,colnum]==1]
days
regdat[,colnum]==1
regdat[,colnum]
regdat$day[regdat$year==y & regdat[,colnum]==1]
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
days
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
for(p in length(podcols)){
quartz()
par(mfrow=c(1,3))
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
#points(x=days,y=rep(y,length=length(days)))
lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
}
}
mtext(paste(pods[p]), side=3,line=1)
mtext(paste(pods[p]), side=3,line=1, adj=0.5)
mtext(paste(pods[p]), side=3,line=2, adj=1)
mtext(paste(pods[p]), side=3,line=2, adj=0)
mtext(paste(pods[p]), side=3,line=2, adj=-5)
mtext(paste(pods[p]), side=3,line=2, adj=1)
mtext(paste(pods[p]), side=3,line=2, adj=0.5)
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
for(p in length(podcols)){
quartz()
par(mfrow=c(1,3))
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
if(r=="uss"){mtext(paste(pods[p]), side=3,line=2, adj=0.5)}
}
}
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
for(p in length(podcols)){
quartz()
par(mfrow=c(1,3))
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
if(r=="uss"){mtext(paste(pods[p]), side=3,line=2, adj=0.5)}
}
}
p
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
for(p in 1:length(podcols)){
quartz(width=10,height=6)
par(mfrow=c(1,3))
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
if(r=="uss"){mtext(paste(pods[p]), side=3,line=2, adj=0.5)}
}
}
podcols<-c("Jpres", "Kpres", "Lpres", "AllSRpres")
pods<-c("J","K","L","SRs")
for(p in 1:length(podcols)){
quartz(width=15,height=6)
par(mfrow=c(1,3))
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="DOY", main=paste(r))
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)))
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
if(r=="uss"){mtext(paste(pods[p]), side=3,line=2, adj=0.5)}
}
}
