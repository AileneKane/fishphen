polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.8),
border=NA)
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.1),
border=NA)
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
if(r=="ps"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("darkblue",alpha.f=0.1),
border=NA)
}
if(r=="uss"){
col="salmon"
polygon(c(244,244,365,365),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.1),
border=NA)
}
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
if(r=="ps"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("darkblue",alpha.f=0.1),
border=NA)
}
if(r=="uss"){
col="salmon"
polygon(c(244,244,365,365),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.1),
border=NA)
}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="ps"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.1),
border=NA)
}
if(r=="uss"){
col="salmon"
polygon(c(244,244,365,365),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor("salmon",alpha.f=0.5),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="ps"){
col="salmon"
polygon(c(121,121,304,304),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor(col,alpha.f=0.1),
border=NA)
}
if(r=="uss"){
col="darkblue"
polygon(c(244,244,365,365),c(max(as.numeric(years)),min(as.numeric(years)),min(as.numeric(years)),max(as.numeric(years))),
col=adjustcolor(col,alpha.f=0.5),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="ps"){
col="salmon"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="uss"){
col="darkblue"
polygon(c(244,244,365,365),c(max(as.numeric(years))+1,min(as.numeric(years))+1,min(as.numeric(years))+1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="ps"){
col="salmon"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="uss"){
col="darkblue"
polygon(c(244,244,365,365),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="uss"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="ps"){
col="salmon"
polygon(c(244,244,365,365),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
figname<-paste("analyses/figures/OrcaPhenPlots/srkw_phenmap.pdf")
pdf(figname,height=6, width=15)
#quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="uss"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="ps"){
col="salmon"
polygon(c(244,244,368,368),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
#summarize the days on which atleast one sighting occured for each lat/long in ps and uss
srlatlon = aggregate(d$SRKW, list(d$Lat,d$Long,d$region,d$Year,d$day),sum)
colnames(srlatlon)<-c("lat","lon","region","year","doy","numsights")
latlons<-srlatlon[srlatlon$region!="oc",]#remove outercoast\
latlons<-latlons[latlons$lat!="",]#remove blank lats
latlons<-latlons[latlons$lon!="0.0000",] #remove weird lon
latlons$pres<-0#add column for 0/1 abs/pres on a given day at the lat/long.
latlons$pres[latlons$numsights>0]<-1
numdays<-aggregate(latlons$pres, list(latlons$lat,latlons$lon,latlons$region,latlons$year),sum)
colnames(numdays)<-c("lat","lon","region","year","numdays")
numdays<-numdays[numdays$numdays>0,]#remove zeros
meannumdays<-aggregate(numdays$numdays, list(numdays$lat,numdays$lon,numdays$region),mean)
colnames(meannumdays)<-c("lat","lon","region","mnnumdays")
#make a map that shows mean number of whale days by lat long in each region
newmap <- getMap(resolution = "low")
#quartz(height=6, width=6)
plot(newmap, xlim = c(-125, -120), ylim = c(47, 49), asp = 1)
points(meannumdays$lon[meannumdays$region=="ps"],meannumdays$lat[meannumdays$region=="ps"],type="p",pch=16, col="darkblue",cex=log(meannumdays$mnnumdays, base=10))
points(meannumdays$lon[meannumdays$region=="uss"],meannumdays$lat[meannumdays$region=="uss"],type="p",pch=16, col="salmon",cex=log(meannumdays$mnnumdays, base=10))
legend(-122.2,48,legend=c("# days per year= 2","# days per year= 78"),
pch=21, bty="n",pt.bg=c("salmon","salmon"), pt.cex=c(log(2, base=10), log(78, base=10)))
dev.off()
#Make a map of observations of SRKW sightings in different regions
#make same plot, but prettier and just for ALL SRs in PS and upper salish sea
figname<-paste("analyses/figures/OrcaPhenPlots/srkw_phenmap.pdf")
pdf(figname,height=6, width=15)
#quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="uss"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="ps"){
col="salmon"
polygon(c(244,244,368,368),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
#summarize the days on which atleast one sighting occured for each lat/long in ps and uss
srlatlon = aggregate(d$SRKW, list(d$Lat,d$Long,d$region,d$Year,d$day),sum)
colnames(srlatlon)<-c("lat","lon","region","year","doy","numsights")
latlons<-srlatlon[srlatlon$region!="oc",]#remove outercoast\
latlons<-latlons[latlons$lat!="",]#remove blank lats
latlons<-latlons[latlons$lon!="0.0000",] #remove weird lon
latlons$pres<-0#add column for 0/1 abs/pres on a given day at the lat/long.
latlons$pres[latlons$numsights>0]<-1
numdays<-aggregate(latlons$pres, list(latlons$lat,latlons$lon,latlons$region,latlons$year),sum)
colnames(numdays)<-c("lat","lon","region","year","numdays")
numdays<-numdays[numdays$numdays>0,]#remove zeros
meannumdays<-aggregate(numdays$numdays, list(numdays$lat,numdays$lon,numdays$region),mean)
colnames(meannumdays)<-c("lat","lon","region","mnnumdays")
#make a map that shows mean number of whale days by lat long in each region
newmap <- getMap(resolution = "low")
#quartz(height=6, width=6)
plot(newmap, xlim = c(-125, -120), ylim = c(47, 49), asp = 1)
points(meannumdays$lon[meannumdays$region=="ps"],meannumdays$lat[meannumdays$region=="ps"],type="p",pch=16, col="salmon",cex=log(meannumdays$mnnumdays, base=10))
points(meannumdays$lon[meannumdays$region=="uss"],meannumdays$lat[meannumdays$region=="uss"],type="p",pch=16, col="darkblue",cex=log(meannumdays$mnnumdays, base=10))
legend(-122.2,48,legend=c("# days per year= 2","# days per year= 78"),
pch=21, bty="n",pt.bg=c("salmon","salmon"), pt.cex=c(log(2, base=10), log(78, base=10)))
dev.off()
#Make a map of observations of SRKW sightings in different regions
#make same plot, but prettier and just for ALL SRs in PS and upper salish sea
figname<-paste("analyses/figures/OrcaPhenPlots/srkw_phenmap.pdf")
pdf(figname,height=6, width=15)
#quartz(height=6, width=15)
par(omi=c(.5,2,.5,.5), mfrow=c(1,3))
podcols<-"AllSRpres"
pods<-"SRs"
#regnames<- c("Winter Area","Summer Area")
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
regions=unique(orcasum.days$region)
regions<- c("ps","uss")#winter = dark blue, summer = salmon
for(r in regions){
regdat<-orcasum.days[orcasum.days$region==r,]
years = unique(orcasum.days$year)
plot(0, type = 'n', las=1, xlim=c(1,366),ylim=c(min(as.numeric(years)),max(as.numeric(years))),ylab="",xlab="Day of year", main="", cex.axis=1.1, cex.lab=1.3)
if(r=="uss"){
col="darkblue"
polygon(c(121,121,304,304),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
if(r=="ps"){
col="salmon"
polygon(c(244,244,368,368),c(max(as.numeric(years))+1,min(as.numeric(years))-1,min(as.numeric(years))-1,max(as.numeric(years))+1),
col=adjustcolor(col,alpha.f=0.2),
border=NA)
}
for(y in years){
yrdat = regdat[regdat$year==y,]
days = yrdat$day[yrdat[,colnum]==1]
points(x=days,y=rep(y,length=length(days)), pch=16,col= col, cex=1.3)
#lines(x=days,y=rep(y,length=length(days)), lwd=2)
}
#if(r=="uss"){mtext(paste(pods[p]), side=3,line=3, adj=0.5)}
if(r=="ps"){mtext("Year", side=2,line=4, adj=0.5)}
}
}
#summarize the days on which atleast one sighting occured for each lat/long in ps and uss
srlatlon = aggregate(d$SRKW, list(d$Lat,d$Long,d$region,d$Year,d$day),sum)
colnames(srlatlon)<-c("lat","lon","region","year","doy","numsights")
latlons<-srlatlon[srlatlon$region!="oc",]#remove outercoast\
latlons<-latlons[latlons$lat!="",]#remove blank lats
latlons<-latlons[latlons$lon!="0.0000",] #remove weird lon
latlons$pres<-0#add column for 0/1 abs/pres on a given day at the lat/long.
latlons$pres[latlons$numsights>0]<-1
numdays<-aggregate(latlons$pres, list(latlons$lat,latlons$lon,latlons$region,latlons$year),sum)
colnames(numdays)<-c("lat","lon","region","year","numdays")
numdays<-numdays[numdays$numdays>0,]#remove zeros
meannumdays<-aggregate(numdays$numdays, list(numdays$lat,numdays$lon,numdays$region),mean)
colnames(meannumdays)<-c("lat","lon","region","mnnumdays")
#make a map that shows mean number of whale days by lat long in each region
newmap <- getMap(resolution = "low")
#quartz(height=6, width=6)
plot(newmap, xlim = c(-125, -120), ylim = c(47, 49), asp = 1)
points(meannumdays$lon[meannumdays$region=="ps"],meannumdays$lat[meannumdays$region=="ps"],type="p",pch=16, col="salmon",cex=log(meannumdays$mnnumdays, base=10))
points(meannumdays$lon[meannumdays$region=="uss"],meannumdays$lat[meannumdays$region=="uss"],type="p",pch=16, col="darkblue",cex=log(meannumdays$mnnumdays, base=10))
legend(-122.2,48,legend=c("# days per year= 2","# days per year= 78"),
pch=21, bty="n",pt.bg=c("darkblue","darkblue"), pt.cex=c(log(2, base=10), log(78, base=10)))
dev.off()
#Figure showing phenological change by phenophase, pod/species, and region
#Goal is to compare rates of change among pods and regions, and between orcas and salmon
#Started August 2, 2019 by Ailene Ettinger
#housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
setwd("~/Documents/GitHub/fishphen")
#or from laptop:
#setwd("/Users/aileneettinger/Documents/GitHub/fishphen")
#Read in summaries of rates of change from orca occupancy model
l2<-read.csv("analyses/output/L_2_uss.csv")
l1<-read.csv("analyses/output/L_1_ps.csv")
l1<-read.csv("analyses/output/L_1sept1_ps.csv")
k2<-read.csv("analyses/output/K_2_uss.csv")
k1<-read.csv("analyses/output/K_1_ps.csv")
k1<-read.csv("analyses/output/K_1sept1_ps.csv")
j2<-read.csv("analyses/output/J_2_uss.csv")
j1<-read.csv("analyses/output/J_1_ps.csv")
j1<-read.csv("analyses/output/J_1sept1_ps.csv")
all2<-rbind(j2,k2,l2)
all1<-rbind(j1,k1,l1)
all2<-all2[order(all2$pod),]
# save plotted results as pdf
pdf(file=paste("analyses/figures/",pod,"/orcaphen_1976_2017","_",region,"_",season,"_",pod,"_",prob,".pdf", sep=""),width=7,height=6)
### plot estimates of peak detectability over all years
#quartz(width=7, height=6)
par(mfcol=c(2,2),mai=c(1,1,1,0.5))
x<-rep(1,times=3)
plot(x,all2$slope.mn[all2$phase=="first"],pch=c(21,22,24),bg="darkblue", ylab= "Change in timing (days)",xaxt="n", xlab="",xlim=c(0,4),ylim=c(-2,1), bty="l")
abline(h=0,lty=2)
arrows(x,all2$slope.lci[all2$phase=="first"],x,all2$slope.uci[all2$phase=="first"], code=3, length=0)
arrows(x+1,all2$slope.lci[all2$phase=="peak"],x+1,all2$slope.uci[all2$phase=="peak"], code=3, length=0)
arrows(x+2,all2$slope.lci[all2$phase=="last"],x+2,all2$slope.uci[all2$phase=="last"], code=3, length=0)
points(x,all2$slope.mn[all2$phase=="first"],pch=c(21,22,24),bg="darkblue")
points(x+1,all2$slope.mn[all2$phase=="peak"],pch=c(21,22,24),bg="darkblue")
points(x+2,all2$slope.mn[all2$phase=="last"],pch=c(21,22,24),bg="darkblue")
axis(side=1,labels=c("First","Peak","Last"), at = c(1,2,3))
plot(x,all1$slope.mn[all1$phase=="first"],pch=c(21,22,24),bg="salmon", ylab= "Change in timing (days)",xaxt="n", xlab="",xlim=c(0,4),ylim=c(-2,1), bty="l")
abline(h=0,lty=2)
arrows(x,all1$slope.lci[all1$phase=="first"],x,all1$slope.uci[all1$phase=="first"], code=3, length=0)
arrows(x+1,all1$slope.lci[all1$phase=="peak"],x+1,all1$slope.uci[all1$phase=="peak"], code=3, length=0)
arrows(x+2,all1$slope.lci[all1$phase=="last"],x+2,all1$slope.uci[all1$phase=="last"], code=3, length=0)
points(x,all1$slope.mn[all1$phase=="first"],pch=c(21,22,24),bg="salmon")
points(x+1,all1$slope.mn[all1$phase=="peak"],pch=c(21,22,24),bg="salmon")
points(x+2,all1$slope.mn[all1$phase=="last"],pch=c(21,22,24),bg="salmon")
axis(side=1,labels=c("First","Peak","Last"), at = c(1,2,3))
quartz(width=7, height=6)
par(mfcol=c(2,2),mai=c(1,1,1,0.5))
x<-rep(1,times=3)
plot(x,all2$slope.mn[all2$phase=="first"],pch=c(21,22,24),bg="darkblue", ylab= "Change in timing (days)",xaxt="n", xlab="",xlim=c(0,4),ylim=c(-2,1), bty="l")
abline(h=0,lty=2)
arrows(x,all2$slope.lci[all2$phase=="first"],x,all2$slope.uci[all2$phase=="first"], code=3, length=0)
arrows(x+1,all2$slope.lci[all2$phase=="peak"],x+1,all2$slope.uci[all2$phase=="peak"], code=3, length=0)
arrows(x+2,all2$slope.lci[all2$phase=="last"],x+2,all2$slope.uci[all2$phase=="last"], code=3, length=0)
points(x,all2$slope.mn[all2$phase=="first"],pch=c(21,22,24),bg="darkblue")
points(x+1,all2$slope.mn[all2$phase=="peak"],pch=c(21,22,24),bg="darkblue")
points(x+2,all2$slope.mn[all2$phase=="last"],pch=c(21,22,24),bg="darkblue")
axis(side=1,labels=c("First","Peak","Last"), at = c(1,2,3))
plot(x,all1$slope.mn[all1$phase=="first"],pch=c(21,22,24),bg="salmon", ylab= "Change in timing (days)",xaxt="n", xlab="",xlim=c(0,4),ylim=c(-2,1), bty="l")
abline(h=0,lty=2)
arrows(x,all1$slope.lci[all1$phase=="first"],x,all1$slope.uci[all1$phase=="first"], code=3, length=0)
arrows(x+1,all1$slope.lci[all1$phase=="peak"],x+1,all1$slope.uci[all1$phase=="peak"], code=3, length=0)
arrows(x+2,all1$slope.lci[all1$phase=="last"],x+2,all1$slope.uci[all1$phase=="last"], code=3, length=0)
points(x,all1$slope.mn[all1$phase=="first"],pch=c(21,22,24),bg="salmon")
points(x+1,all1$slope.mn[all1$phase=="peak"],pch=c(21,22,24),bg="salmon")
points(x+2,all1$slope.mn[all1$phase=="last"],pch=c(21,22,24),bg="salmon")
axis(side=1,labels=c("First","Peak","Last"), at = c(1,2,3))
##Add salmon
shifts<-read.csv( "analyses/output/salmonreturntrends.csv", header=TRUE)
head(shifts)
head(shifts)
2+2
