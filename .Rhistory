#albchin95$year[which(albchin95$firstobsdate==max(albchin95$firstobsdate, na.rm=TRUE))]#2007
points(albchin95$firstobsdate,lime.df$firstest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
legend("topleft",legend=c("1994","2017"), pch=21, pt.bg=c(cols[1], cols[length(cols)]), bty="n", cex=1.4)
mod<-lm(lime.df$firstest.all~albchin95$firstobsdate)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
quartz(height=4,width=12)
par(mfrow=c(1,3))
plot(albchin95$firstobsdate,gests95$peakoc.doy,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
#what is the really late salmon year?
#albchin95$year[which(albchin95$firstobsdate==max(albchin95$firstobsdate, na.rm=TRUE))]#2007
points(albchin95$firstobsdate,lime.df$firstest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
legend("topleft",legend=c("1994","2017"), pch=21, pt.bg=c(cols[1], cols[length(cols)]), bty="n", cex=1.4)
mod<-lm(lime.df$firstest.all~albchin95$firstobsdate)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
#whale days vs chinook run size
plot(albchin95$alltotal,lime.df$nobs,type="p",pch=21, bg = cols[factor(albchin95$year)],cex.axis=1.3,cex.lab=1.3,xlab="Chinook Abundance (cpue)",ylab="Whale days", cex=1.2, bty="l")
points(albchin95$alltotal,lime.df$nobs,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
mod<-lm(lime.df$nobs~albchin95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3, lwd=2)}
mod<-lm(lime.df$nobs[8:23]~lime.df$year[8:23])
summary(mod)
confint(mod)
#compare lime kiln phenology to whol region phenology from 2002-2017
#Lastobs of SRKW vs total run size###Could add this
plot(albchin95$alltotal,lime.df$lastest.all,type="p",pch=21, bg = cols[factor(albchin95$year)],cex.axis=1.3,cex.lab=1.3,xlab="Chinook Abundance (cpue)",ylab="SRKW Departure (doy)", cex=1.2, bty="l")
points(albchin95$alltotal,lime.df$lastest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
mod<-lm(lime.df$lastest.all~albchin95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1,lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,lwd=2)}
# points(albchin95$alltotal,lime.df$lastest.p,pch=16, col = "blue",cex=1.2)
# mod<-lm(lime.df$lastest.p~albchin95$
head(albchin95)
head(albchinest95)
albchinest95<-albchinest[albchinest$year>1994,]
head(albchinest95)
head(gests)
plot(albchin95$firstobsdate,gests95$peakoc.doy,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
plot(albchin95$firstobsdate,lime.df$firstest.all,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
head(lime.df)
limegests
range(limegests$prob.occ)
yrfirst.doy<-yeardat$doy[min(which(yeardat$prob.occ>0.5))]
min(which(yeardat$prob.occ>0.5))
min(which(yeardat$prob.occ>0.5))
min(which(yeardat$prob.occ>0.5))
yeardat
yrfirst.doy<-yeardat$doy[min(which(yeardat$prob.occ>0.01))]
#fit gams of srkw prob of presence
#source(orca_rungams_lime.R)#take a long time
limegests<-read.csv("analyses/output/limekiln.srkw.gamests.csv", header=TRUE)
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
yrpeakoc<-max(yeardat$prob.occ)
yrpeakoc.doy<-yeardat$doy[which(yeardat$prob.occ==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(yeardat$prob.occ>0.01))]
yrlast.doy<-yeardat$doy[max(which(yeardat$prob.occ>0.01))]
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy))
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob))
row.names(gests)<-NULL
orcasum.days.lime1<-limegests[limegests$year>1993 & limegests$year<2006,]
orcasum.days.lime2<-limegests[limegests$year>=2006 & limegests$year<2018,]
wdays.old<-cbind(aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),mean),aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),sd)$x,aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),length)$x)
wdays.rec<-cbind(aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),mean),aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),sd)$x,aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),length)$x)
colnames(wdays.old)<-colnames(wdays.rec)<-c("doy","meanocc","sdocc","n")
wdays.old$seocc<-wdays.old$sdocc/sqrt(wdays.old$n)
wdays.rec$seocc<-wdays.rec$sdocc/sqrt(wdays.rec$n)
library(igraph)
#quartz(height=6, width=12)
pdf("analyses/orcaphen/figures/orcachinphenoverlap.pdf",height=6, width=12)
# to figure out how much to shift the salmon curve earlier- because they are measured at ft. langely on the frasier river, but we are interested in when they are at lime kiln
# lime  kiln is ~160 km from lime kiln "as the fish swims" and fish swim about 70 km per day! only need to shift by 2-3 days?
par(oma=c(1,1,1,3), mar=c(4,4,4,6))
shift<--14
plot(cpue.old$doy[7:220]+shift,running_mean(cpue.old$cpue.mean,7),xlim=c(120,250),ylim=c(0,max(cpue.old$cpue.mean)+max(cpue.old$cpue.sd,na.rm=TRUE)),type="l", bty="u",col="salmon", lwd=2, lty=2,ylab="Chinook Abundance (mean cpue)", xlab="Day of Year")
polygon(c(rev(cpue.old$doy[7:220]+shift),cpue.old$doy[7:220]+shift),c(rev(running_mean(cpue.old$cpue.mean,7)+cpue.old$cpue.sd[7:220]),running_mean(cpue.old$cpue.mean,7)-cpue.old$cpue.sd[7:220]),col=alpha("salmon",0.1),lty=0)
polygon(c(rev(cpue.rec$doy[7:205]+shift),cpue.rec$doy[7:205]+shift),c(rev(running_mean(cpue.rec$cpue.mean,7)+cpue.rec$cpue.sd[7:205]),running_mean(cpue.rec$cpue.mean,7)-cpue.rec$cpue.sd[7:205]),col=alpha("salmon",0.1),lty=0)
lines(cpue.rec$doy[7:205]+shift,running_mean(cpue.rec$cpue.mean,7), lwd=2,col="salmon")
par(new = TRUE)
plot(wdays.old$doy[7:129],running_mean(wdays.old$meanocc,7), type="l",lty=2, lwd=2,col="black", xlim=c(120,250), ylim=c(0,1), yaxt="n", ylab="",xaxt="n", xlab="", bty="l")
polygon(c(rev(wdays.old$doy[7:129]),wdays.old$doy[7:129]),c(rev(running_mean(wdays.old$meanocc,7)+wdays.old$sdocc[7:129]),running_mean(wdays.old$meanocc,7)-wdays.old$sdocc[7:129]),col=alpha("black",0.05),lty=0)
polygon(c(rev(wdays.rec$doy[7:129]),wdays.rec$doy[7:129]),c(rev(running_mean(wdays.rec$meanocc,7)+wdays.rec$sdocc[7:129]),running_mean(wdays.rec$meanocc,7)-wdays.rec$sdocc[7:129]),col=alpha("black",0.05),lty=0)
lines(wdays.rec$doy[7:129],running_mean(wdays.rec$mean,7), lwd=2,col="black")
axis(side = 4)
mtext("SRKW presence",side=4, adj=.5, line=2)
legend(115,1,legend=c("1994-2005","2006-2017"),lty=c(2,1),lwd=2,col="black", bty="n")
legend(115,.85,legend=c("SRKW","salmon"),lty=1,lwd=2,col=c("black","salmon"), bty="n")
dev.off()
gests95<-gests[gests$years>1993,]
gests95<-gests95[gests95$years!=2014,]
quartz(height=4,width=12)
par(mfrow=c(1,4))
plot(albchin95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
limegests<-read.csv("analyses/output/limekiln.srkw.gamests.csv", header=TRUE)
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
yrpeakoc<-max(yeardat$prob.occ)
yrpeakoc.doy<-yeardat$doy[which(yeardat$prob.occ==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(yeardat$prob.occ>0.1))]
yrlast.doy<-yeardat$doy[max(which(yeardat$prob.occ>0.1))]
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob))
row.names(gests)<-NULL
orcasum.days.lime1<-limegests[limegests$year>1993 & limegests$year<2006,]
orcasum.days.lime2<-limegests[limegests$year>=2006 & limegests$year<2018,]
wdays.old<-cbind(aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),mean),aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),sd)$x,aggregate(orcasum.days.lime1$prob.occ,by=list(orcasum.days.lime1$doy),length)$x)
wdays.rec<-cbind(aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),mean),aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),sd)$x,aggregate(orcasum.days.lime2$prob.occ,by=list(orcasum.days.lime2$doy),length)$x)
colnames(wdays.old)<-colnames(wdays.rec)<-c("doy","meanocc","sdocc","n")
wdays.old$seocc<-wdays.old$sdocc/sqrt(wdays.old$n)
wdays.rec$seocc<-wdays.rec$sdocc/sqrt(wdays.rec$n)
library(igraph)
gests95<-gests[gests$years>1993,]
gests95<-gests95[gests95$years!=2014,]
quartz(height=4,width=12)
par(mfrow=c(1,4))
plot(albchin95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
#
quartz(height=4,width=12)
par(mfrow=c(1,4))
plot(albchin95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Arrival (doy)", cex=1.2, bty="l")
plot(albchinest95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Arrival (doy)", cex=1.2, bty="l")
albchinest95$
albchinest95$firstobsdate
head(albchinest95)
albchinest95$year
albchinest95<-albchinest95[albchinest95$year<2018,]
plot(albchinest95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Arrival (doy)", cex=1.2, bty="l")
#what is the really late salmon year?
#albchin95$year[which(albchin95$firstobsdate==max(albchin95$firstobsdate, na.rm=TRUE))]#2007
points(albchin95$firstobsdate,lime.df$firstest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
quartz(height=4,width=12)
par(mfrow=c(1,4))
albchinest95<-albchinest95[albchinest95$year<2018,]
plot(albchinest95$firstobsdate,gests95$firstprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchin95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Arrival (doy)", cex=1.2, bty="l")
#what is the really late salmon year?
#albchin95$year[which(albchin95$firstobsdate==max(albchin95$firstobsdate, na.rm=TRUE))]#2007
#points(albchin95$firstobsdate,lime.df$firstest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
legend("topleft",legend=c("1994","2017"), pch=21, pt.bg=c(cols[1], cols[length(cols)]), bty="n", cex=1.4)
mod<-lm(gests95$firstprob~albchinest95$firstobsdate)
summary(mod)
limewdaysabs
unique(limewdaysabs$AllSRpres)
head(orcasum.days.lime)
#aggregate whale days
#first add zeros
limeyears<-unique(orcasum.days.lime$year)
alllimeabs<-c()
for(y in limeyears){
days<-seq(from=min(orcasum.days.lime$day), to = max(orcasum.days.lime$day), by=1)
abs<-rep(0,times=length(days))
years<-rep(y, times=length(days))
limeabs<-cbind(years,days,abs)
alllimeabs<-rbind(alllimeabs,limeabs)
}
alllimeabs<-as.data.frame(alllimeabs)
limewdayspres<-subset(orcasum.days.lime, select=c(year,day,AllSRpres,Jpres,Kpres,Lpres))
colnames(alllimeabs)[1:2]<-colnames(limewdayspres)[1:2]
alllimeabs$day<-as.numeric(alllimeabs$day)
alllimeabs$abs<-as.numeric(alllimeabs$abs)
limewdaysabs<-left_join(alllimeabs,limewdayspres)
head(limewdaysabs)
#replace NAs with 0
limewdaysabs$AllSRpres[which(is.na(limewdaysabs$AllSRpres))]<-0
limewdaysabs$Jpres[which(is.na(limewdaysabs$AllSRpres))]<-0
limewdaysabs$Jpres[which(is.na(limewdaysabs$Jpres))]<-0
#aggregate whale days
#first add zeros
limeyears<-unique(orcasum.days.lime$year)
alllimeabs<-c()
for(y in limeyears){
days<-seq(from=min(orcasum.days.lime$day), to = max(orcasum.days.lime$day), by=1)
abs<-rep(0,times=length(days))
years<-rep(y, times=length(days))
limeabs<-cbind(years,days,abs)
alllimeabs<-rbind(alllimeabs,limeabs)
}
alllimeabs<-as.data.frame(alllimeabs)
limewdayspres<-subset(orcasum.days.lime, select=c(year,day,AllSRpres,Jpres,Kpres,Lpres))
colnames(alllimeabs)[1:2]<-colnames(limewdayspres)[1:2]
alllimeabs$day<-as.numeric(alllimeabs$day)
alllimeabs$abs<-as.numeric(alllimeabs$abs)
limewdaysabs<-left_join(alllimeabs,limewdayspres)
#replace NAs with 0
limewdaysabs$AllSRpres[which(is.na(limewdaysabs$AllSRpres))]<-0
limewdaysabs$Jpres[which(is.na(limewdaysabs$Jpres))]<-0
limewdaysabs$Kpres[which(is.na(limewdaysabs$Kpres))]<-0
limewdaysabs$Lpres[which(is.na(limewdaysabs$Lpres))]<-0
head(limewdaysabs)
tail(limewdaysabs)
tail(limewdaysabs)
unique(limewdaysabs$AllSRpres)
unique(limewdaysabs$JRpres)
unique(limewdaysabs$Jpres)
unique(limewdaysabs$Kpres)
unique(limewdaysabs$Lpres)
j<-limewdaysabs$Jpres
k<-limewdaysabs$Kpres
l<-limewdaysabs$Lpres
head(limewdaysabs)
doy<-limewdaysabs$day
year<-as.factor(limewdaysabs$year)
#mod<-gam(y ~ s(doy,by=year),family=binomial)
library(sme)
fit<-sme(y,doy,year,criteria="AIC",family=binomial)
doy
year
#Fit a bernouli gam with presence of SRs as the response
y<-limewdaysabs$AllSRpres
fit<-sme(y,doy,year,criteria="AIC",family=binomial)
fitj<-sme(j,doy,year,criteria="AIC",family=binomial)
fitk<-sme(k,doy,year,criteria="AIC",family=binomial)
fitl<-sme(l,doy,year,criteria="AIC",family=binomial)
quartz()
plot(fit,type="diagnostic")
fit$info
quartz()
plot(fit,type="model",xlab="doy",ylab="probability of occurrence")
length(fit$fitted)
summary(fit)
plot(fit,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="SRKW Presence at Lime Kiln")
head(fit$fitted)
preds<-as.data.frame(fit$fitted)
preds$year<-substr(rownames(preds),1,4)
#preds$n<-substr(rownames(preds),5,length(rownames(preds)))
preds$doy<-limewdaysabs$day
colnames(preds)[1]<-"prob.occ"
preds$prob.occ[preds$prob.occ<0]<-0
preds
#preds$n<-substr(rownames(preds),5,length(rownames(preds)))
preds$doy<-limewdaysabs$day
colnames(preds)[1]<-"prob.occ"
preds$prob.occ[preds$prob.occ<0]<-0
head(preds)
head(fitj)
predsj<-as.data.frame(fitj$fitted)
predsk<-as.data.frame(fitk$fitted)
predsl<-as.data.frame(fitl$fitted)
head(predsj)
dim(fitj)
dim(predsj)
dim(predsk)
dim(predsl)
dim(preds)
preds<-cbind(preds,predsj$`fitj$fitted`,predsk$`fitk$fitted`,predsl$`fitl$fitted`)
head(preds)
colnames(preds)[4:6]<-c("jprob.occ","kprob.occ","lprob.occ")
preds$prob.occ[preds$prob.occ<0]<-0
preds$jprob.occ[preds$jprob.occ<0]<-0
preds$kprob.occ[preds$kprob.occ<0]<-0
preds$lprob.occ[preds$lprob.occ<0]<-0
head(peds)
head(preds)
tail(preds)
plot(fitj,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="J Presence at Lime Kiln")
quartz()
plot(fitj,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="J Presence at Lime Kiln")
plot(fitk,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="K Presence at Lime Kiln")
quartz()
plot(fitj,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="J Presence at Lime Kiln")
quartz()
plot(fitl,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="L Presence at Lime Kiln")
plot(fitk,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="K Presence at Lime Kiln")
plot(fitl,type="raw",showModelFits=TRUE,xlab="Day of Year",ylab="L Presence at Lime Kiln")
head(fit$fitted)
preds<-as.data.frame(fit$fitted)
predsj<-as.data.frame(fitj$fitted)
predsk<-as.data.frame(fitk$fitted)
predsl<-as.data.frame(fitl$fitted)
preds$year<-substr(rownames(preds),1,4)
#preds$n<-substr(rownames(preds),5,length(rownames(preds)))
preds$doy<-limewdaysabs$day
preds<-cbind(preds,predsj$`fitj$fitted`,predsk$`fitk$fitted`,predsl$`fitl$fitted`)
colnames(preds)[1]<-"prob.occ"
colnames(preds)[4:6]<-c("jprob.occ","kprob.occ","lprob.occ")
preds$prob.occ[preds$prob.occ<0]<-0
preds$jprob.occ[preds$jprob.occ<0]<-0
preds$kprob.occ[preds$kprob.occ<0]<-0
preds$lprob.occ[preds$lprob.occ<0]<-0
head(preds)
write.csv(preds,"analyses/output/limekiln.srkw.gamests.csv", row.names=FALSE)
summary(fit)
coef(fit)
#fit gams of srkw prob of presence
#source(orca_rungams_lime.R)#take a long time
limegests<-read.csv("analyses/output/limekiln.srkw.gamests.csv", header=TRUE)
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
yrpeakoc<-max(yeardat$prob.occ)
yrpeakoc.doy<-yeardat$doy[which(yeardat$prob.occ==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(yeardat$prob.occ>0.1))]
yrlast.doy<-yeardat$doy[max(which(yeardat$prob.occ>0.1))]
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob))
gests
yeardat$prob.occ
colnames(yeardat)
which(colnames(yeardat)=="prob.occ")
yrpeakoc<-max(yeardat[,which(colnames(yeardat)=="prob.occ")])
yrpeakoc
occprobcol="prob.occ"
yrpeakoc<-max(yeardat[,which(colnames(yeardat)==occprobcol)])
yrpeakoc
occprobs="prob.occ"
occprobcol<-which(colnames(yeardat)==occprobs)
yrpeakoc<-max(yeardat[,occprobcol])
yrpeakoc
occprobcol<-yeardat[,which(colnames(yeardat)==occprobs)]
occprobcol
#fit gams of srkw prob of presence
#source(orca_rungams_lime.R)#take a long time
limegests<-read.csv("analyses/output/limekiln.srkw.gamests.csv", header=TRUE)
get.gests<-function(limegests,occprobs){
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
meanprob<-c()
meanprob.lc<-c()
meanprob.uc<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
occprobcol<-yeardat[,which(colnames(yeardat)==occprobs)]
yrpeakoc<-max(occprobcol)
yrpeakoc.doy<-yeardat$doy[which(occprobcol==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(occprobcol>0.1))]
yrlast.doy<-yeardat$doy[max(which(occprobcol>0.1))]
meanprob<-mean(occprobcol)
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
meanprobs<-c(meanprobs,meanprob)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob))
row.names(gests)<-NULL
return(gests)
}
colnames(limefests)
colnames(limegests)
gests<-get.gests(limegests,"prob.occ")
quantile(yeardat$prob.occ,0.25)
quantile(yeardat$prob.occ,0.75)
get.gests<-function(limegests,occprobs){
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
meanprobs<-c()
prob.lc<-c()
prob.uc<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
occprobcol<-yeardat[,which(colnames(yeardat)==occprobs)]
yrpeakoc<-max(occprobcol)
yrpeakoc.doy<-yeardat$doy[which(occprobcol==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(occprobcol>0.1))]
yrlast.doy<-yeardat$doy[max(which(occprobcol>0.1))]
meanprob<-mean(occprobcol)
lprob<-quantile(occprobcol,0.25)
uprob<-quantile(occprobcol,0.75)
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
meanprobs<-c(meanprobs,meanprob)
prob.lc<-c(prob.lc,lprob)
prob.uc<-c(prob.uc,uprob)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob))
row.names(gests)<-NULL
return(gests)
}
gests<-get.gests(limegests,"prob.occ")
jgests<-get.gests(limegests,"jprob.occ")
kgests<-get.gests(limegests,"kprob.occ")
lgests<-get.gests(limegests,"lprob.occ")
get.gests<-function(limegests,occprobs){
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
meanprobs<-c()
prob.lc<-c()
prob.uc<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
occprobcol<-yeardat[,which(colnames(yeardat)==occprobs)]
yrpeakoc<-max(occprobcol)
yrpeakoc.doy<-yeardat$doy[which(occprobcol==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(occprobcol>0.1))]
yrlast.doy<-yeardat$doy[max(which(occprobcol>0.1))]
meanprob<-mean(occprobcol)
lprob<-quantile(occprobcol,0.25)
uprob<-quantile(occprobcol,0.75)
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
meanprobs<-c(meanprobs,meanprob)
prob.lc<-c(prob.lc,lprob)
prob.uc<-c(prob.uc,uprob)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob,meanprobsprob.lc,prob.uc))
row.names(gests)<-NULL
return(gests)
}
gests<-get.gests(limegests,"prob.occ")
get.gests<-function(limegests,occprobs){
peakoc.doy<-c()
peakoc<-c()
firstprob<-c()
lastprob<-c()
meanprobs<-c()
prob.lc<-c()
prob.uc<-c()
years<-c()
for(y in unique(limegests$year)){
yeardat<-limegests[limegests$year==y,]
occprobcol<-yeardat[,which(colnames(yeardat)==occprobs)]
yrpeakoc<-max(occprobcol)
yrpeakoc.doy<-yeardat$doy[which(occprobcol==yrpeakoc)]
yrfirst.doy<-yeardat$doy[min(which(occprobcol>0.1))]
yrlast.doy<-yeardat$doy[max(which(occprobcol>0.1))]
meanprob<-mean(occprobcol)
lprob<-quantile(occprobcol,0.25)
uprob<-quantile(occprobcol,0.75)
peakoc<-c(peakoc,yrpeakoc)
peakoc.doy<-c(peakoc.doy,yrpeakoc.doy)
firstprob<-c(firstprob,yrfirst.doy)
lastprob<-c(lastprob,yrlast.doy)
meanprobs<-c(meanprobs,meanprob)
prob.lc<-c(prob.lc,lprob)
prob.uc<-c(prob.uc,uprob)
years<-c(years,y)
}
gests<-as.data.frame(cbind(years,peakoc,peakoc.doy,firstprob,lastprob,meanprobs,prob.lc,prob.uc))
row.names(gests)<-NULL
return(gests)
}
gests<-get.gests(limegests,"prob.occ")
jgests<-get.gests(limegests,"jprob.occ")
kgests<-get.gests(limegests,"kprob.occ")
lgests<-get.gests(limegests,"lprob.occ")
gests
jgests<-get.gests(limegests,"jprob.occ")
kgests<-get.gests(limegests,"kprob.occ")
lgests<-get.gests(limegests,"lprob.occ")
lm(gests$meanprobs~guests$year)
lm(gests$meanprobs~gests$year)
summary(lm(gests$meanprobs~gests$year))
#trned is getting lower
summary(lm(jgests$meanprobs~gests$year))
summary(lm(jgests$meanprobs~jgests$year))#not getting lower
summary(lm(kgests$meanprobs~kgests$year))#not getting lower
summary(lm(lgests$meanprobs~lgests$year))#getting lower
jgests
summary(lm(gests$peakoc.doy~gests$year))#trend is getting lower
summary(lm(jgests$peakoc.doy~jgests$year))#not getting lower
summary(lm(kgests$peakoc.doy~kgests$year))#getting lower
summary(lm(lgests$peakoc.doy~lgests$year))#getting lower
summary(lm(gests$peakoc.doy~gests$year))#trend is getting later
confint(lm(gests$meanprobs~gests$year))
confint(lm(gests$peakoc.doy~gests$year))#trend is getting later
confint(lm(gests$firstprob~gests$year))#trend is getting later
sumamry(lm(gests$firstprob~gests$year))#trend is getting later
summary(lm(gests$firstprob~gests$year))#trend is getting later
summary(lm(gests$lastprob~gests$year))#trend is getting later
confint(lm(gests$lastprob~gests$year))#trend is getting later
confint(lm(gests$lastprob~gests$year), .90)#trend is getting later
confint(lm(gests$lastprob~gests$year), level=.90)#trend is getting later
confint(lm(gests$peakoc.doy~gests$year), .90)
confint(lm(gests$peakoc.doy~gests$year),level= .90)
confint(lm(gests$firstprob~gests$year), .90)
confint(lm(gests$firstprob~gests$year), level=.90)
