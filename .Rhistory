#mod<-lm(gests$firstprob~albchinest95$firstobsdate)
#if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
#if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
# plot(albchinest95$firstobsdate,gests$peakoc.doy,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchinest95$year)],xlab="Chinook Arrival (doy)",ylab="SRKW Peak Occupancy prob (doy)", cex=1.2, bty="l")
# mod<-lm(gests$peakoc.doy~albchinest95$firstobsdate)
# if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
# if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
plot(albchinest95$peakobsdate,gests$peakoc.doy,type="p",pch=21, cex.axis=1.8,cex.lab=1.8,bg = cols[factor(albchinest95$year)],xlab="Day of Peak Chinook Abundance (DOY)",ylab="Day of Peak SRKW Occupancy Probability (DOY)", cex=1.8, bty="l")
mod<-lm(gests$peakoc.doy~albchinest95$peakobsdate)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
mtext("B)", side = 3, line = 1, adj=0)
#
# plot(albchinest95$lastobsdate,gests$lastprob,type="p",pch=21, cex.axis=1.3,cex.lab=1.3,bg = cols[factor(albchinest95$year)],xlab="Chinook Arrival (doy)",ylab="Day of Peak SRKW Occupancy Probability (DOY)", cex=1.2, bty="l")
# mod<-lm(gests$lastprob~albchinest95$lastobsdate)
# if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
# if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
plot(albchinest95$alltotal,gests$peakoc.doy, type="p",pch=21, cex.axis=1.8,cex.lab=1.8,bg = cols[factor(albchinest95$year)],xlab="Chinook Abundance (CPUE)",ylab="Day of Peak SRKW Occupancy Probability (DOY)", cex=1.8, bty="l")
mod<-lm(gests$peakoc.doy~albchinest95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,  lwd=2)}
mtext("C)", side = 3, line = 1, adj=0)
#whale days vs chinook run size
plot(albchin95$alltotal,limewhaledays.prob$whdays.prob,type="p",pch=21, bg = cols[factor(albchin95$year)],cex.axis=1.8,cex.lab=1.8,xlab="Chinook Abundance (CPUE)",ylab="Whale days (#)", cex=1.8, bty="l")
#points(albchin95$alltotal,limewhaledays.prob$whdays.prob,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
mod<-lm(limewhaledays.prob$whdays.prob~albchin95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3, lwd=2)}
mtext("D)", side = 3, line = 1, adj=0)
dev.off()
mod<-lm(lime.df$nobs~albchin95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3, lwd=2)}
mod<-lm(lime.df$nobs[8:23]~lime.df$year[8:23])
summary(mod)
confint(mod)
#compare lime kiln phenology to whol region phenology from 2002-2017
#Lastobs of SRKW vs total run size###Could add this
plot(albchin95$alltotal,lime.df$lastest.all,type="p",pch=21, bg = cols[factor(albchin95$year)],cex.axis=1.3,cex.lab=1.3,xlab="Chinook Abundance (cpue)",ylab="SRKW Departure (doy)", cex=1.2, bty="l")
points(albchin95$alltotal,lime.df$lastest.all,pch=21, bg = cols[factor(albchin95$year)],cex=1.5)
mod<-lm(lime.df$lastest.all~albchin95$alltotal)
if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1,lwd=2)}
if(summary(mod)$coef[2,4]<.15 & summary(mod)$coef[2,4]>.05){abline(mod, lty=3,lwd=2)}
# points(albchin95$alltotal,lime.df$lastest.p,pch=16, col = "blue",cex=1.2)
# mod<-lm(lime.df$lastest.p~albchin95$alltotal)
# if(summary(mod)$coef[2,4]<.05){abline(mod, lty=1, col="blue")}
# if(summary(mod)$coef[2,4]<.15){abline(mod, lty=3, col = "blue")}
dev.off()
#Make figures of model estimated whale days
limedays<-read.csv("analyses/output/lime_prob.occ.50.csv", header=TRUE)
limedays$year<-as.numeric(limewdaysabs$year)
limedays<-limedays[limedays$year>1991,]
yearsum<-aggregate(limedays$SRprob.Estimate,by=list(limedays$year),sum)
jsum<-aggregate(limedays$Jprob.Estimate,by=list(limedays$year),sum)
ksum<-aggregate(limedays$Kprob.Estimate,by=list(limedays$year),sum)
lsum<-aggregate(limedays$Lprob.Estimate,by=list(limedays$year),sum)
colnames(yearsum)<-colnames(jsum)<-colnames(ksum)<-colnames(lsum)<-c("year","wdays")
limewdaysabs$year<-as.factor(limewdaysabs$year)
limewdaysabs
quartz(height=12,width=12)
#quartz(height=12,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2,main = "All Pods")
head(limewdaysabs)
limedays
#sum actual wale days for comparison
jsumobs<-aggregate(limewdaysabs$Jpres,by=list(limewdaysabs$year),sum)
ksumobs<-aggregate(limewdaysabs$Kpres,by=list(limewdaysabs$year),sum)
lsumobs<-aggregate(limewdaysabs$Lpres,by=list(limewdaysabs$year),sum)
allsumobs<-aggregate(limewdaysabs$JAllSRpres,by=list(limewdaysabs$year),sum)
allsumobs<-aggregate(limewdaysabs$AllSRpres,by=list(limewdaysabs$year),sum)
head(allsumobs)
colnames(jsumobs)<-colnames(ksumobs)<-colnames(lsumobs)<-colnames(allsumobs)<-c("year","wdays")
yearsum$year
allsumobs$year
#sum actual wale days for comparison
limewdaysabs<-limewdaysabs[limewdaysabs$year>1991,]
#sum actual wale days for comparison
limewdaysabs<-limewdaysabs[as.numeric(limewdaysabs$year)>1991,]
jsumobs<-aggregate(limewdaysabs$Jpres,by=list(limewdaysabs$year),sum)
ksumobs<-aggregate(limewdaysabs$Kpres,by=list(limewdaysabs$year),sum)
lsumobs<-aggregate(limewdaysabs$Lpres,by=list(limewdaysabs$year),sum)
allsumobs<-aggregate(limewdaysabs$AllSRpres,by=list(limewdaysabs$year),sum)
colnames(jsumobs)<-colnames(ksumobs)<-colnames(lsumobs)<-colnames(allsumobs)<-c("year","wdays")
windows(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col="medblue",lwd=2)
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col="mediumblue",lwd=2)
as.numeric(allsumobs$year)
allsumobs
#sum actual wale days for comparison
limewdaysabs<-limewdaysabs[as.numeric(limewdaysabs$year)>1991,]
jsumobs<-aggregate(limewdaysabs$Jpres,by=list(limewdaysabs$year),sum)
jsumobs
limewdaysabs
head(limewdays)
#4. Get data in terms of number of observations per day and "whale days": days on which whales were seen (presence/absence for each day)
source("analyses/orcaphen/source/orca_get_whaledays.R")
# Set working directory:
#setwd("~/GitHub/fishphen")
#or from laptop:
#setwd("/Users/aileneettinger/Documents/GitHub/fishphen")
# Load libraries
library(dplyr)
library(mgcv)
library(scales)
library(RColorBrewer)
library(rworldmap)
library(scales)
library(matrixStats)
library(plotfunctions)
library(igraph)
library(brms)
# 1. Choose the years, regions of interest, assumption about reports in the OrcaMaster and get the data
includeCanada=TRUE
firstyear=1976#probably set to 1975 or 1976 (Olson et al)
assumeSRKW=FALSE #If true, assume that "Orcas" means SRKW unless noted otherwuse (i.e. Transients or NRKWs)
use3regions=FALSE#If true, separate out the straight of Juan de Fuca as a 3rd region, distinct from CSS and PS (all code not yet working for 3 regions!)
#Set start of seasons
ps.start<-182#July 1 = 182
uss.start<-91#April 1 = 91,
d <- read.csv("data/AppendixII.csv")
quads<-read.csv("data/QuadCentroids.csv")
dim(d)#105344  18 on Nov 08, 2019
# 2. Clean the data (also saved in output/AppendixII_cleaned,csv)
source("analyses/orcaphen/source/clean_orca.R")
dim(d)#105339     21 on Nov 8, 2019
# 3. Limit space and time to firstyear or later and Salish Sea, Puget Sound, Washington Outer Coast
source("analyses/orcaphen/source/orca_limitspacetime.R")
dim(d)#103121      22
#table(d$FishArea,d$region)#check regions are correct
#4. Get data in terms of number of observations per day and "whale days": days on which whales were seen (presence/absence for each day)
source("analyses/orcaphen/source/orca_get_whaledays.R")
#5. Summarize and plot whale days
wdays<-as.data.frame(tapply(orcasum.days$AllSRpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.J<-as.data.frame(tapply(orcasum.days$Jpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.K<-as.data.frame(tapply(orcasum.days$Kpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.L<-as.data.frame(tapply(orcasum.days$Lpres,list(orcasum.days$year,orcasum.days$region),sum))
source("analyses/orcaphen/source/orca_plot_whaledays.R")
limewdaysabs$year<-as.factor(limewdaysabs$year)
#Make figures of model estimated whale days
limedays<-read.csv("analyses/output/lime_prob.occ.50.csv", header=TRUE)
limedays$year<-as.numeric(limewdaysabs$year)
limedays<-limedays[limedays$year>1991,]
yearsum<-aggregate(limedays$SRprob.Estimate,by=list(limedays$year),sum)
jsum<-aggregate(limedays$Jprob.Estimate,by=list(limedays$year),sum)
ksum<-aggregate(limedays$Kprob.Estimate,by=list(limedays$year),sum)
lsum<-aggregate(limedays$Lprob.Estimate,by=list(limedays$year),sum)
colnames(yearsum)<-colnames(jsum)<-colnames(ksum)<-colnames(lsum)<-c("year","wdays")
#sum actual wale days for comparison
limewdaysabs<-limewdaysabs[as.numeric(limewdaysabs$year)>1991,]
limewdaysabs
as.numeric(limewdaysabs$year)
#4. Get data in terms of number of observations per day and "whale days": days on which whales were seen (presence/absence for each day)
source("analyses/orcaphen/source/orca_get_whaledays.R")
limewdaysabs
#Look at some basic stats about orca observations
#Started with orca_dataprep_occmodel.R code
#4 February 2019
#housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
#setwd("~/GitHub/fishphen")
#or from laptop:
#setwd("/Users/aileneettinger/Documents/GitHub/fishphen")
# Load libraries
library(dplyr)
library(mgcv)
library(scales)
library(RColorBrewer)
library(rworldmap)
library(scales)
library(matrixStats)
library(plotfunctions)
library(igraph)
library(brms)
# 1. Choose the years, regions of interest, assumption about reports in the OrcaMaster and get the data
includeCanada=TRUE
firstyear=1976#probably set to 1975 or 1976 (Olson et al)
assumeSRKW=FALSE #If true, assume that "Orcas" means SRKW unless noted otherwuse (i.e. Transients or NRKWs)
use3regions=FALSE#If true, separate out the straight of Juan de Fuca as a 3rd region, distinct from CSS and PS (all code not yet working for 3 regions!)
#Set start of seasons
ps.start<-182#July 1 = 182
uss.start<-91#April 1 = 91,
d <- read.csv("data/AppendixII.csv")
quads<-read.csv("data/QuadCentroids.csv")
dim(d)#105344  18 on Nov 08, 2019
# 2. Clean the data (also saved in output/AppendixII_cleaned,csv)
source("analyses/orcaphen/source/clean_orca.R")
dim(d)#105339     21 on Nov 8, 2019
# 3. Limit space and time to firstyear or later and Salish Sea, Puget Sound, Washington Outer Coast
source("analyses/orcaphen/source/orca_limitspacetime.R")
dim(d)#103121      22
#table(d$FishArea,d$region)#check regions are correct
#4. Get data in terms of number of observations per day and "whale days": days on which whales were seen (presence/absence for each day)
source("analyses/orcaphen/source/orca_get_whaledays.R")
#5. Summarize and plot whale days
wdays<-as.data.frame(tapply(orcasum.days$AllSRpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.J<-as.data.frame(tapply(orcasum.days$Jpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.K<-as.data.frame(tapply(orcasum.days$Kpres,list(orcasum.days$year,orcasum.days$region),sum))
wdays.L<-as.data.frame(tapply(orcasum.days$Lpres,list(orcasum.days$year,orcasum.days$region),sum))
source("analyses/orcaphen/source/orca_plot_whaledays.R")
limewdaysabs
limewday
#6. if you want to do some other basic plots of the data. This includes proportion of days in a week in which whales were observed up by week and decade
source("analyses/orcaphen/source/orca_plotdata.R")
#7. Make a map of the SRKW sightings in ps and uss
source("analyses/orcaphen/source/orca_makemap.R")
#8a. Prep the lime kiln only data for either gams or linear models
source("analyses/orcaphen/source/orca_get_whaledays_lime.R")
#8b. Fit some basic linear models to all srkw data
styr=1978#or 2001
source("analyses/orcaphen/source/orca_runlinmods.R")
limewdaysabs
goo<-limewdaysabs
#Make figures of model estimated whale days
limedays<-read.csv("analyses/output/lime_prob.occ.50.csv", header=TRUE)
limedays$year<-as.numeric(limewdaysabs$year)
limedays<-limedays[limedays$year>1991,]
yearsum<-aggregate(limedays$SRprob.Estimate,by=list(limedays$year),sum)
jsum<-aggregate(limedays$Jprob.Estimate,by=list(limedays$year),sum)
ksum<-aggregate(limedays$Kprob.Estimate,by=list(limedays$year),sum)
lsum<-aggregate(limedays$Lprob.Estimate,by=list(limedays$year),sum)
colnames(yearsum)<-colnames(jsum)<-colnames(ksum)<-colnames(lsum)<-c("year","wdays")
#sum actual wale days for comparison
limewdaysabs<-limewdaysabs[as.numeric(limewdaysabs$year)>1991,]
limewdaysabs
jsumobs<-aggregate(limewdaysabs$Jpres,by=list(limewdaysabs$year),sum)
ksumobs<-aggregate(limewdaysabs$Kpres,by=list(limewdaysabs$year),sum)
lsumobs<-aggregate(limewdaysabs$Lpres,by=list(limewdaysabs$year),sum)
allsumobs<-aggregate(limewdaysabs$AllSRpres,by=list(limewdaysabs$year),sum)
colnames(jsumobs)<-colnames(ksumobs)<-colnames(lsumobs)<-colnames(allsumobs)<-c("year","wdays")
quartz(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col="mediumblue",lwd=2)
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col="lightblue",lwd=2)
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
quartz(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("A)", side = 3, line = 1, adj=0)
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("D)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue")
quartz(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
mtext("D)", side = 3, line = 1, adj=0)
dev.off()
head(limedays)
yearsum.lc<-aggregate(limedays$SRprob.Q25,by=list(limedays$year),sum)
jsum.lc<-aggregate(limedays$Jprob.Q25,by=list(limedays$year),sum)
ksum.lcv<-aggregate(limedays$Kprob.Q25,by=list(limedays$year),sum)
lsum.lc<-aggregate(limedays$Lprob.Q25,by=list(limedays$year),sum)
yearsum.uc<-aggregate(limedays$SRprob.Q75,by=list(limedays$year),sum)
jsum.uc<-aggregate(limedays$Jprob.Q75,by=list(limedays$year),sum)
ksum.ucv<-aggregate(limedays$Kprob.Q75,by=list(limedays$year),sum)
lsum.uc<-aggregate(limedays$Lprob.Q75,by=list(limedays$year),sum)
ksum.uc<-aggregate(limedays$Kprob.Q75,by=list(limedays$year),sum)
ksum.lc<-aggregate(limedays$Kprob.Q25,by=list(limedays$year),sum)
colnames(yearsum)<-colnames(jsum)<-colnames(ksum)<-colnames(lsum)<-
colnames(yearsum.lc)<-colnames(jsum.lc)<-colnames(ksum.lc)<-colnames(lsum.lc)<-
colnames(yearsum.uc)<-colnames(jsum.uc)<-colnames(ksum.uc)<-colnames(lsum.uc)<-c("year","wdays")
allsumobs.uc
quartz(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(1,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
dev.off()
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
head(chinab)
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
chinsum
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1991,]
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1991,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$cpue,ylab= "Year", xlab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
as.numeric(chinsum$year)
chinsum$cpue
plot(as.numeric(chinsum$year),chinsum$totalcpue,ylab= "Year", xlab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
chinab<-chinab[chinab$year>1991,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,ylab= "Year", xlab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1991,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,ylab= "Year", xlab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
dev.off()
yearsum$year
as.numeric(chinsum$year)
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1991,]
chinab<-chinab[chinab$year<2018,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,xlab= "Year", ylab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
dev.off()
chinsum
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1993,]
chinab<-chinab[chinab$year<2018,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,xlab= "Year", ylab= "Total Estimated Chinook Abundance", bty="l", type="l", col="salmon",lwd=2)
dev.off()
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1993,]
chinab<-chinab[chinab$year<2018,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,xlab= "Year", ylab= "Total Estimated Chinook Abundance", bty="l", lty=2,type="l", col="salmon",lwd=2)
dev.off()
png(filename="analyses/orcaphen/figures/modwhaledays_lime.png",height=480,width=960)
#quartz(height=6,width=12)
par(mfrow=c(2,4))
plot(as.numeric(yearsum$year),yearsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col=alpha("darkblue",0.8),lwd=2,main = "All Pods")
lines(as.numeric(allsumobs$year),allsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(yearsum$year)),as.numeric(yearsum$year)), c(rev(yearsum.uc$wdays), yearsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("A)", side = 3, line = 1, adj=0)
legend("bottomleft",legend=c("Observed", "Model estimate"), lty=c(1,2), col="darkblue", lwd=2, bty="n")
plot(as.numeric(jsum$year),jsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "J Pod")
lines(as.numeric(jsumobs$year),jsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(jsum$year)),as.numeric(jsum$year)), c(rev(jsum.uc$wdays), jsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("B)", side = 3, line = 1, adj=0)
plot(as.numeric(ksum$year),ksum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "K Pod")
lines(as.numeric(ksumobs$year),ksumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(ksum$year)),as.numeric(ksum$year)), c(rev(ksum.uc$wdays), ksum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("C)", side = 3, line = 1, adj=0)
plot(as.numeric(lsum$year),lsum$wdays,ylab= "Year", xlab= "Number of Modeled Whale Days", bty="l", type="l", col="darkblue",lwd=2, main = "L Pod")
lines(as.numeric(lsumobs$year),lsumobs$wdays, type="l", col=alpha("darkblue",0.8),, lty=2,lwd=2)
polygon(c(rev(as.numeric(lsum$year)),as.numeric(lsum$year)), c(rev(lsum.uc$wdays), lsum.lc$wdays), col = alpha("darkblue", 0.2), border = NA)
mtext("D)", side = 3, line = 1, adj=0)
#Add modeled salmon cpue
chinab<-read.csv("analyses/output/albiongamests.csv", header = TRUE)
#restrict days
chinab<-chinab[chinab$doy<230,]
chinab<-chinab[chinab$doy>90,]
chinab<-chinab[chinab$year>1993,]
chinab<-chinab[chinab$year<2018,]
chinsum<-aggregate(chinab$cpue.est,by=list(chinab$year),sum)
colnames(chinsum)<-c("year","totalcpue")
plot(as.numeric(chinsum$year),chinsum$totalcpue,xlab= "Year", ylab= "Total Estimated Chinook Abundance", bty="l", lty=2,type="l", col="salmon",lwd=2)
mtext("E)", side = 3, line = 1, adj=0)
dev.off()
