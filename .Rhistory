abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
#last obs
plot(pod.df$year,pod.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(pod.df)[i+8]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+10]~pod.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
i
quartz()
par(mfrow=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(pod.df$year,pod.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(pod.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+4]~pod.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
#last obs
plot(pod.df$year,pod.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(pod.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+10]~pod.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
pod.df
quartz()
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(pod.df$year,pod.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(pod.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+4]~pod.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
mod<-lm(pod.df[,i+4]~pod.df$year)
pod.df[,i+4]
pod.df$year
mod<-lm(pod.df[,i+4]~pod.df$year)
pod.df$firstest.1jul.all[which(pod.df$firstest.1jul.all=="Inf")]<-NA
pod.df$firstest.1aug.all[which(pod.df$firstest.1aug.all=="Inf")]<-NA
pod.df$firstest.1sep.all[which(pod.df$firstest.1sep.all=="Inf")]<-NA
pod.df$firstest.1oct.all[which(pod.df$firstest.1oct.all=="Inf")]<-NA
pod.df$firstest.1may.all[which(pod.df$firstest.1may.all=="Inf")]<-NA
pod.df$firstest.1jun.all[which(pod.df$firstest.1jun.all=="Inf")]<-NA
for(i in 1:6){
#first obs with jul1 st window
plot(pod.df$year,pod.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(pod.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+4]~pod.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
quartz()
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(pod.df$year,pod.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(pod.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+4]~pod.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(pod.df$year,pod.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(pod.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+10]~pod.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
i
mod
summary(mod)
i=1
for(i in 1:5){
#last obs
plot(pod.df$year,pod.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(pod.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+10]~pod.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
pod.df
quartz()
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(pod.df$year,pod.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(pod.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+4]~pod.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(pod.df$year,pod.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(pod.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(pod.df[,i+10]~pod.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
regions=unique(orcasum.days$region)
podcols<-c("AllSRpres")#just do for all SRs for now
pods<-c("SRs")
#Create dataframe with first, last obs for each start date in each year
pods.all<-c()
regions.all<-c()
years.all<-c()
nobs.all<-c()
firstest.1may.all<-c()
firstest.1jun.all<-c()#1
firstest.1jul.all<-c()
firstest.1aug.all<-c()
firstest.1sep.all<-c()
firstest.1oct.all<-c()
lastest.31dec.all<-c()
lastest.31jan.all<-c()
lastest.28feb.all<-c()
lastest.31mar.all<-c()
lastest.all<-c()
years<-unique(orcasum.days$orcayear)#use July 1 as start of orca year, as this will encompass min start date window that i want to try
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
for(r in 1:length(regions)){
regdat<-orcasum.days[orcasum.days$region==regions[r],]
# if (regions[r]=="uss"){
#
#   regdat<-regdat[as.numeric(regdat$day)<273,]#look at data before Sept 30 for USS
#   regdat<-regdat[as.numeric(regdat$day)>121,]#look at data after May 1 for USS
# }
#
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all<-c(pods.all,pods[p])
regions.all<-c(regions.all,regions[r])
years.all<-c(years.all,years[y])
nobs.all<-c(nobs.all,length(yrdat$day[yrdat[,colnum]==1]))
if (regions[r]=="ps"){
yrdat<- yrdat[as.numeric(yrdat$daysaftapr30)<=273,]#look between start date and mar31
firstest.1may.all<-c(firstest.1may.all,min(yrdat$daysaftapr30[yrdat[,colnum]==1], na.rm=TRUE))#1may=1 day after apr30stdays
firstest.1jun.all<-c(firstest.1jun.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=32 & yrdat[,colnum]==1], na.rm=TRUE))#1jun=32 days after apr30
firstest.1jul.all<-c(firstest.1jul.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=62 & yrdat[,colnum]==1], na.rm=TRUE))#1jul=63 days after apr30
firstest.1aug.all<-c(firstest.1aug.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=93 & yrdat[,colnum]==1], na.rm=TRUE))#1aug=93 days after apr30
firstest.1sep.all<-c(firstest.1sep.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=124 & yrdat[,colnum]==1], na.rm=TRUE))#1sep=124 days after apr30
firstest.1oct.all<-c(firstest.1oct.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=154 & yrdat[,colnum]==1], na.rm=TRUE))#1aug=154 days after apr30
lastest.31dec.all<-c(lastest.31dec.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=245 & yrdat[,colnum]==1], na.rm=TRUE))#31dec = 245 days after apr30
lastest.31jan.all<-c(lastest.31jan.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=276 & yrdat[,colnum]==1], na.rm=TRUE))#31jan = 276 days after apr30
lastest.28feb.all<-c(lastest.28feb.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=304 & yrdat[,colnum]==1], na.rm=TRUE))#28feb=304 days after apr30
lastest.31mar.all<-c(lastest.31mar.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=336 & yrdat[,colnum]==1], na.rm=TRUE))#31mar= 336 days after apr30
lastest.all<-c(lastest.all,max(yrdat$daysaftapr30[yrdat[,colnum]==1], na.rm=TRUE))#31mar= 336 days after apr30
}
}
}
}
pods.all<-c()
regions.all<-c()
years.all<-c()
nobs.all<-c()
firstest.1may.all<-c()
firstest.1jun.all<-c()#1
firstest.1jul.all<-c()
firstest.1aug.all<-c()
firstest.1sep.all<-c()
firstest.1oct.all<-c()
lastest.31dec.all<-c()
lastest.31jan.all<-c()
lastest.28feb.all<-c()
lastest.31mar.all<-c()
lastest.all<-c()
years<-unique(orcasum.days$orcayear)#use July 1 as start of orca year, as this will encompass min start date window that i want to try
for(p in 1:length(podcols)){
colnum<-which(colnames(orcasum.days)==podcols[p])
for(r in 1:length(regions)){
regdat<-orcasum.days[orcasum.days$region==regions[r],]
# if (regions[r]=="uss"){
#
#   regdat<-regdat[as.numeric(regdat$day)<273,]#look at data before Sept 30 for USS
#   regdat<-regdat[as.numeric(regdat$day)>121,]#look at data after May 1 for USS
# }
#
for(y in 1:length(years)){
yrdat<-regdat[regdat$orcayear==years[y],]
pods.all<-c(pods.all,pods[p])
regions.all<-c(regions.all,regions[r])
years.all<-c(years.all,years[y])
nobs.all<-c(nobs.all,length(yrdat$day[yrdat[,colnum]==1]))
#if (regions[r]=="ps"){
yrdat<- yrdat[as.numeric(yrdat$daysaftapr30)<=273,]#look between start date and mar31
firstest.1may.all<-c(firstest.1may.all,min(yrdat$daysaftapr30[yrdat[,colnum]==1], na.rm=TRUE))#1may=1 day after apr30stdays
firstest.1jun.all<-c(firstest.1jun.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=32 & yrdat[,colnum]==1], na.rm=TRUE))#1jun=32 days after apr30
firstest.1jul.all<-c(firstest.1jul.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=62 & yrdat[,colnum]==1], na.rm=TRUE))#1jul=63 days after apr30
firstest.1aug.all<-c(firstest.1aug.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=93 & yrdat[,colnum]==1], na.rm=TRUE))#1aug=93 days after apr30
firstest.1sep.all<-c(firstest.1sep.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=124 & yrdat[,colnum]==1], na.rm=TRUE))#1sep=124 days after apr30
firstest.1oct.all<-c(firstest.1oct.all,min(yrdat$daysaftapr30[yrdat$daysaftapr30>=154 & yrdat[,colnum]==1], na.rm=TRUE))#1aug=154 days after apr30
lastest.31dec.all<-c(lastest.31dec.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=245 & yrdat[,colnum]==1], na.rm=TRUE))#31dec = 245 days after apr30
lastest.31jan.all<-c(lastest.31jan.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=276 & yrdat[,colnum]==1], na.rm=TRUE))#31jan = 276 days after apr30
lastest.28feb.all<-c(lastest.28feb.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=304 & yrdat[,colnum]==1], na.rm=TRUE))#28feb=304 days after apr30
lastest.31mar.all<-c(lastest.31mar.all,max(yrdat$daysaftapr30[yrdat$daysaftapr30<=336 & yrdat[,colnum]==1], na.rm=TRUE))#31mar= 336 days after apr30
lastest.all<-c(lastest.all,max(yrdat$daysaftapr30[yrdat[,colnum]==1], na.rm=TRUE))#31mar= 336 days after apr30
#}
}
}
}
warnings()
df <- as.data.frame(cbind(pods.all,regions.all,years.all,nobs.all,firstest.1may.all,firstest.1jun.all,firstest.1jul.all,firstest.1aug.all,firstest.1sep.all,firstest.1oct.all,
lastest.31dec.all,lastest.31jan.all,lastest.28feb.all,lastest.31mar.all, lastest.all))
colnames(df)[1:4]<-c("pod","region","year","nobs")
pod.df=df[df$pod=="SRs",]
dim(pod.df)
head(pod.df)
pod.df$firstest.1may.all[which(pod.df$firstest.1may.all=="Inf")]<-NA
pod.df$firstest.1jun.all[which(pod.df$firstest.1jun.all=="Inf")]<-NA
pod.df$firstest.1jul.all[which(pod.df$firstest.1jul.all=="Inf")]<-NA
pod.df$firstest.1aug.all[which(pod.df$firstest.1aug.all=="Inf")]<-NA
pod.df$firstest.1sep.all[which(pod.df$firstest.1sep.all=="Inf")]<-NA
pod.df$firstest.1oct.all[which(pod.df$firstest.1oct.all=="Inf")]<-NA
pod.df$lastest.31dec.all[which(pod.df$lastest.31dec.all=="-Inf")]<-NA
pod.df$lastest.31jan.all[which(pod.df$lastest.31jan.all=="-Inf")]<-NA
pod.df$lastest.28feb.all[which(pod.df$lastest.28feb.all=="-Inf")]<-NA
pod.df$lastest.31mar.all[which(pod.df$lastest.31mar.all=="-Inf")]<-NA
#
pod.df$firstest.1may.all<-as.numeric(pod.df$firstest.1may.all)
pod.df$firstest.1jun.all<-as.numeric(pod.df$firstest.1jun.all)
pod.df$firstest.1jul.all<-as.numeric(pod.df$firstest.1jul.all)
pod.df$firstest.1aug.all<-as.numeric(pod.df$firstest.1aug.all)
pod.df$firstest.1sep.all<-as.numeric(pod.df$firstest.1sep.all)
pod.df$firstest.1oct.all<-as.numeric(pod.df$firstest.1oct.all)
pod.df$lastest.31dec.all<-as.numeric(pod.df$lastest.31dec.all)
pod.df$lastest.31jan.all<-as.numeric(pod.df$lastest.31jan.all)
pod.df$lastest.28feb.all<-as.numeric(pod.df$lastest.28feb.all)
pod.df$lastest.31mar.all<-as.numeric(pod.df$lastest.31mar.all)
pod.df$lastest.all<-as.numeric(pod.df$lastest.all)
pod.df$year<-as.numeric(pod.df$year)
head(pod.df)
r=1
reg.dat<-pod.df[pod.df$region==region[r],]
regions
reg.dat<-pod.df[pod.df$region==regions[r],]
reg.dat
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=8,width=5)
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~regf$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(reg.df$year,regf[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(regf[,i+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~regf$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(reg.df$year,regf[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg[,i+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(reg.df$year,regf[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg[,i+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(i in 1:5){
#last obs
plot(reg.df$year,reg.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[i+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg[,i+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
#last obs
plot(reg.df$year,reg.df[,i+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[i+10]), bty="l", pch=21, bg="gray")
reg.df[,i+10]
reg.df
colnames(reg.df)
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(j in 1:5){
#last obs
plot(reg.df$year,reg.df[,j+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[j+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,j+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
r
pod.df$lastest..all[which(pod.df$lastest.all=="-Inf")]<-NA
mod<-lm(reg.df[,j+10]~reg.df$year)
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(j in 1:5){
#last obs
plot(reg.df$year,reg.df[,j+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[j+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,j+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
pod.df$lastest.all
pod.df$lastest.all[which(pod.df$lastest.all=="-Inf")]<-NA
pod.df$lastest.all<-as.numeric(pod.df$lastest.all)
pod.df$year<-as.numeric(pod.df$year)
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(j in 1:5){
#last obs
plot(reg.df$year,reg.df[,j+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[j+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,j+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4],regions[r]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(j in 1:5){
#last obs
plot(reg.df$year,reg.df[,j+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[j+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,j+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
lastest.31mar.all
max(yrdat$daysaftapr30[yrdat$daysaftapr30<=336 & yrdat[,colnum]==1]
, na.rm=TRUE))
max(yrdat$daysaftapr30[yrdat$daysaftapr30<=336 & yrdat[,colnum]==1], na.rm=TRUE)
unique(orcasum.days$orcayear)
years
y
y=40
regions
r=1
orcasum.days[substr(orcasum.days$date,6,10)=="05-10"]
orcasum.days[substr(orcasum.days$date,6,10)=="05-10",]
orcasum.days[substr(orcasum.days$date,6,10)=="05-01",]
orcasum.days[substr(orcasum.days$date,6,10)=="04-30",]
pod.df=df[df$pod=="SRs",]
pod.df$firstest.1may.all[which(pod.df$firstest.1may.all=="Inf")]<-NA
pod.df$firstest.1jun.all[which(pod.df$firstest.1jun.all=="Inf")]<-NA
pod.df$firstest.1jul.all[which(pod.df$firstest.1jul.all=="Inf")]<-NA
pod.df$firstest.1aug.all[which(pod.df$firstest.1aug.all=="Inf")]<-NA
pod.df$firstest.1sep.all[which(pod.df$firstest.1sep.all=="Inf")]<-NA
pod.df$firstest.1oct.all[which(pod.df$firstest.1oct.all=="Inf")]<-NA
pod.df$lastest.31dec.all[which(pod.df$lastest.31dec.all=="-Inf")]<-NA
pod.df$lastest.31jan.all[which(pod.df$lastest.31jan.all=="-Inf")]<-NA
pod.df$lastest.28feb.all[which(pod.df$lastest.28feb.all=="-Inf")]<-NA
pod.df$lastest.31mar.all[which(pod.df$lastest.31mar.all=="-Inf")]<-NA
pod.df$lastest.all[which(pod.df$lastest.all=="-Inf")]<-NA
#
pod.df$firstest.1may.all<-as.numeric(pod.df$firstest.1may.all)
pod.df$firstest.1jun.all<-as.numeric(pod.df$firstest.1jun.all)
pod.df$firstest.1jul.all<-as.numeric(pod.df$firstest.1jul.all)
pod.df$firstest.1aug.all<-as.numeric(pod.df$firstest.1aug.all)
pod.df$firstest.1sep.all<-as.numeric(pod.df$firstest.1sep.all)
pod.df$firstest.1oct.all<-as.numeric(pod.df$firstest.1oct.all)
pod.df$lastest.31dec.all<-as.numeric(pod.df$lastest.31dec.all)
pod.df$lastest.31jan.all<-as.numeric(pod.df$lastest.31jan.all)
pod.df$lastest.28feb.all<-as.numeric(pod.df$lastest.28feb.all)
pod.df$lastest.31mar.all<-as.numeric(pod.df$lastest.31mar.all)
pod.df$lastest.all<-as.numeric(pod.df$lastest.all)
pod.df$year<-as.numeric(pod.df$year)
for(r in 1:length(regions)){
reg.df<-pod.df[pod.df$region==regions[r],]
quartz(height=10,width=7)
par(mfcol=c(6,2))
for(i in 1:6){
#first obs with jul1 st window
plot(reg.df$year,reg.df[,i+4],xlab="year",ylab="first obs doy", main=paste(colnames(reg.df)[i+4],regions[r]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,i+4]~reg.df$year)
abline(mod)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
for(j in 1:5){
#last obs
plot(reg.df$year,reg.df[,j+10],xlab="year",ylab="last obs doy", main=paste(colnames(reg.df)[j+10]), bty="l", pch=21, bg="gray")
mod<-lm(reg.df[,j+10]~reg.df$year)
mtext(paste("r2=",round(summary(mod)$r.squared, digits=2),",p=",round(summary(mod)$coeff[2,4], digits=2)), side=3, adj=1, cex=0.7)
abline(mod)
print(summary(mod))
mtext(paste("coef=",round(summary(mod)$coeff[2,1], digits=2)), side=3,line=-1, adj=1, cex=0.7)
}
}
tapply(pod.df$firstest.1may.all,list(pod.df$region),mean, na.rm=TRUE)
tapply(pod.df$lastest.all,list(pod.df$region),mean, na.rm=TRUE)
