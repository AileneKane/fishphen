}
}
#Look at effect of increasing effort on estimate of first observation and estimate of last observation
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
obs<-c(lowobs,highobs)
nobs<-c()
firstest<-c()
lastest<-c()
meanest<-c()
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
obs<-c(lowobs,highobs)
nobs<-c()
firstest<-c()
lastest<-c()
meanest<-c()
for(j in 1:length(obs)){
for (i in 1:length(nreps)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-cbind(days, whaleobs)
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,obs[j]), ])
nobs[i*j]<-obs[j]
firstest[i*j]<-min(obs$days[obs$whaleobs==1])
lastest[i*j]<-max(obs$days[obs$whaleobs==1])
meanest[i*j]<-mean(obs$days[obs$whaleobs==1])
}
}
obs[j]
#Look at effect of increasing effort on estimate of first observation and estimate of last observation
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
nobs<-c()
firstest<-c()
lastest<-c()
meanest<-c()
for(j in 1:length(numobs)){
for (i in 1:length(nreps)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-cbind(days, whaleobs)
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
nobs[i*j]<-obs[j]
firstest[i*j]<-min(obs$days[obs$whaleobs==1])
lastest[i*j]<-max(obs$days[obs$whaleobs==1])
meanest[i*j]<-mean(obs$days[obs$whaleobs==1])
}
}
nobs
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
nobs<-c()
firstest<-c()
lastest<-c()
meanest<-c()
for(j in 1:length(numobs)){
for (i in 1:length(nreps)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-cbind(days, whaleobs)
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
nobs[i*j]<-numobs[j]
firstest[i*j]<-min(obs$days[obs$whaleobs==1])
lastest[i*j]<-max(obs$days[obs$whaleobs==1])
meanest[i*j]<-mean(obs$days[obs$whaleobs==1])
}
}
numobs
nobs
firstest
numobs<-c(lowobs,highobs)
nobs<-c()
firstest<-c()
lastest<-c()
meanest<-c()
for(j in 1:length(numobs)){
for (i in 1:length(nreps)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-cbind(days, whaleobs)
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
nobs<-c(nobs,numobs[j])
firstest<-c(firstest,min(obs$days[obs$whaleobs==1]))
lastest<-c(lastest,max(obs$days[obs$whaleobs==1]))
meanest<-c(meanest,mean(obs$days[obs$whaleobs==1]))
}
}
nobs
firstest
lastest
obs
df <- data.frame(nobs=integer(),
firstest=integer(),
lastest=integer(),
meanest=integer(),
firsttrue=integer(),
lasttrue=integer(),
meantrue=integer(),
stringsAsFactors=FALSE)
df
numobs
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whaleobs
whalepres<-cbind(days, whaleobs)
whalepres
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
obs
df$nobs<-numobs[j]
df$nobs
df
df$nobs[j*i]<-numobs[j]
df$nobs[j*i]
numobs[j]
df <- as.data.frame(matrix(NA,nrows=numobs*nreps,ncols=7))
numobs*nreps
numobs
df <- as.data.frame(matrix(NA,nrows=length(numobs)*nreps,ncols=7))
length(numobs)*nreps
matrix(NA,nrows=length(numobs)*nreps,ncols=7)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
df
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
length(numobs)
nreps
i=1
j=1
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-cbind(days, whaleobs)
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest<-mean(obs$days[obs$whaleobs==1])
df$meantrue<-mean(whalepres$days[whalepres$whaleobs==1])
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest<-mean(obs$days[obs$whaleobs==1])
df$firsttrue<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue<-mean(whalepres$days[whalepres$whaleobs==1])
df
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
for(j in 1:length(numobs)){
for (i in 1:nreps){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest[j*i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[j*i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[j*i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[j*i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
}
df
nreps
numobs[j]
length(numobs)
j=1
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
for (i in 1:nreps){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest[j*i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[j*i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[j*i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[j*i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
df
j=2
for (i in 1:nreps){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest[j*i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[j*i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[j*i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[j*i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
df
j=1
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
for (i in 1:nreps){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[j]), ])
df$nobs[j*i]<-numobs[j]
df$firstest[j*i]<- min(obs$days[obs$whaleobs==1])
df$lastest[j*i]<-max(obs$days[obs$whaleobs==1])
df$meanest[j*i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[j*i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[j*i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[j*i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
df
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
numobs
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
for (i in 1:length(numobs)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[i]), ])
df$nobs[i]<-numobs[i]
df$firstest[i]<- min(obs$days[obs$whaleobs==1])
df$lastest[i]<-max(obs$days[obs$whaleobs==1])
df$meanest[i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
df
boxplot(df$firstest~as.factor(df$nobs))
t.test(df$firstest,as.factor(df$nobs))
t.test(df$firstest~as.factor(df$nobs))
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy")
t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
quartz()
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
names(t)
t$conf.int
t$estimate
t$estimate[1]
quartz()
par(mfrow=c(1,3))
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy")
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2))
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2),side=3,line=-3, adj=1)
)
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],difits=2),"-",round(t$conf.int[2],difits=2),")"),side=3,line=-3, adj=1)
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],difits=2),"-",round(t$conf.int[2],digits=2),")"),side=3,line=-3, adj=1)
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),"-",round(t$conf.int[2],digits=2),")"),side=3,line=-3, adj=1)
mtext(paste(round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),"-",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
quartz()
par(mfrow=c(1,3))
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste(Change=round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),"-",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
head(df)
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
lowobs<-20#number of days whales observed in 1970s
highobs<-100#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
for (i in 1:length(numobs)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[i]), ])
df$nobs[i]<-numobs[i]
df$firstest[i]<- min(obs$days[obs$whaleobs==1])
df$lastest[i]<-max(obs$days[obs$whaleobs==1])
df$meanest[i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
lowobs<-20#number of days whales observed in 1970s
highobs<-200#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
for (i in 1:length(numobs)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[i]), ])
df$nobs[i]<-numobs[i]
df$firstest[i]<- min(obs$days[obs$whaleobs==1])
df$lastest[i]<-max(obs$days[obs$whaleobs==1])
df$meanest[i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
nreps<-10#look at effect of increasing observations on estimates
lowobs<-80#number of days whales observed in 1970s
highobs<-160#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
for (i in 1:length(numobs)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[i]), ])
df$nobs[i]<-numobs[i]
df$firstest[i]<- min(obs$days[obs$whaleobs==1])
df$lastest[i]<-max(obs$days[obs$whaleobs==1])
df$meanest[i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[2]-t$estimate[1], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of observations", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
lowobs<-50#number of days whales observed in 1970s
highobs<-250#number of days whales observed in 2000
numobs<-c(lowobs,highobs)
df <- as.data.frame(matrix(nrow=length(numobs)*nreps,ncol=7))
colnames(df)<-c("nobs","firstest","lastest","meanest","firsttrue", "lasttrue","meantrue")
numobs<-c(rep(lowobs,nreps),rep(highobs,nreps))
for (i in 1:length(numobs)){
springobs<-sample(c(0,1), length(springdays), replace=TRUE, prob = c(1-springprob,springprob))
summerobs<-sample(c(0,1), length(summerdays), replace=TRUE, prob = c(1-summerprob,summerprob))
fallobs<-sample(c(0,1), length(falldays), replace=TRUE, prob = c(1-fallprob,fallprob))
#put together the true data
days<-c(springdays,summerdays,falldays)
whaleobs<-c(springobs,summerobs,fallobs)
whalepres<-as.data.frame(cbind(days, whaleobs))
obs<-as.data.frame(whalepres[sample(nrow(whalepres), replace=TRUE,numobs[i]), ])
df$nobs[i]<-numobs[i]
df$firstest[i]<- min(obs$days[obs$whaleobs==1])
df$lastest[i]<-max(obs$days[obs$whaleobs==1])
df$meanest[i]<-mean(obs$days[obs$whaleobs==1])
df$firsttrue[i]<-min(whalepres$days[whalepres$whaleobs==1])
df$lasttrue[i]<-max(whalepres$days[whalepres$whaleobs==1])
df$meantrue[i]<-mean(whalepres$days[whalepres$whaleobs==1])
}
quartz()
par(mfrow=c(1,3))
#First obs
boxplot(df$firstest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of first obs (doy)", main="First obs")
t<-t.test(df$firstest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Last obs
boxplot(df$lastest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of last obs (doy)", main="Last obs")
t<-t.test(df$lastest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
#Mean obs
boxplot(df$meanest~as.factor(df$nobs), xlab="Number of days observed", ylab="Estimate of mean obs (doy)", main="Mean obs")
t<-t.test(df$meanest~as.factor(df$nobs), conf.level=0.8)
mtext(paste("Change=",round(t$estimate[1]-t$estimate[2], digits=2),"(",round(t$conf.int[1],digits=2),",",round(t$conf.int[2],digits=2),")", sep=""),side=3,line=-3, adj=1)
